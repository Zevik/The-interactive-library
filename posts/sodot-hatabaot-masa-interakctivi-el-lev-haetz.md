---
title: "×¡×•×“×•×ª ×”×˜×‘×¢×•×ª: ××¡×¢ ××™× ×˜×¨××§×˜×™×‘×™ ××œ ×œ×‘ ×”×¢×¥"
english_slug: sodot-hatabaot-masa-interakctivi-el-lev-haetz
category: "×‘×™×•×œ×•×’×™×”"
tags: [×‘×•×˜× ×™×§×”, ×¦××—×™×, ×’×“×™×œ×”, ×˜×‘×¢×•×ª ×©× ×ª×™×•×ª, ×¡×™××•×œ×¦×™×”, ××™× ×˜×¨××§×˜×™×‘×™, ××§×œ×™×]
---
# ×¡×•×“×•×ª ×”×˜×‘×¢×•×ª: ××¡×¢ ××™× ×˜×¨××§×˜×™×‘×™ ××œ ×œ×‘ ×”×¢×¥
×“××™×™× ×• ×©×”×™×™×ª× ×™×›×•×œ×™× ×œ×§×¨×•× ××ª ×”×¡×™×¤×•×¨ ×©×œ ×¢×¥, ×©× ×” ××—×¨ ×©× ×”, ×××© ×‘×ª×•×š ×”×’×–×¢ ×©×œ×•. ×˜×‘×¢×•×ª ×”×’×“×™×œ×” ×”×Ÿ ×‘×“×™×•×§ ×–×” â€“ ×™×•××Ÿ ××¡×¢ ×˜×‘×¢×™ ×”××ª×¢×“ ××ª ×ª× ××™ ×”×¡×‘×™×‘×” ×©×¢×™×¦×‘×• ××ª ×—×™×™×•. ×‘×¡×™××•×œ×˜×•×¨ ×–×”, ××ª× ×”×‘×××™×! ×§×‘×¢×• ××ª ××–×’ ×”××•×•×™×¨ ×•×’×•×¨××™× ××—×¨×™×, ×•×¦×¤×• ×›×™×¦×“ ×”×—×œ×˜×•×ª×™×›× ××©×¤×™×¢×•×ª ×¢×œ ×”×¢×¥, ×©× ×” ××—×¨ ×©× ×”. ×’×œ×• ××ª ×”×§×©×¨ ×”××¨×ª×§ ×‘×™×Ÿ ×”×˜×‘×¢ ×œ×¡×™×¤×•×¨ ×©×—×¨×•×ª ×¢×œ ×”×¢×¥.

<div class="app-container">
    <div class="app-header">
        <h2>×¡×™××•×œ×˜×•×¨ ×’×“×™×œ×ª ×˜×‘×¢×•×ª ×¢×¥</h2>
        <div class="year-info">
            <span class="year-label">×©× ×”:</span> <span id="current-year" class="year-number">0</span>
        </div>
    </div>

    <div class="simulator-content">
        <div class="controls-panel">
            <h3>×ª× ××™ ×”×¡×‘×™×‘×” ×”×©× ×ª×™×™×:</h3>
            <div class="condition-sliders">
                <div class="slider-group">
                    <label for="precipitation">ğŸ’¦ ×›××•×ª ××©×§×¢×™×:</label>
                    <input type="range" id="precipitation" min="1" max="10" value="5">
                    <span id="precipitation-value" class="slider-value">5</span>
                    <p class="slider-tip">××™× ×”× ×”×—×™×™×! ×›×›×œ ×©×™×© ×™×•×ª×¨ ×’×©×, ×”×’×“×™×œ×” ××”×™×¨×” ×™×•×ª×¨.</p>
                </div>
                <div class="slider-group">
                    <label for="sunlight">â˜€ï¸ ×¢×•×¦××ª ×§×¨×™× ×ª ×©××©:</label>
                    <input type="range" id="sunlight" min="1" max="10" value="5">
                    <span id="sunlight-value" class="slider-value">5</span>
                    <p class="slider-tip">××•×¨ ×©××© ×—×™×•× ×™ ×œ×¤×•×˜×•×¡×™× ×ª×–×”. ×™×•×ª×¨ ××•×¨ = ×™×•×ª×¨ ×× ×¨×’×™×” ×œ×’×“×™×œ×”.</p>
                </div>
                <div class="slider-group">
                    <label for="temperature">ğŸŒ¡ï¸ ×˜××¤×¨×˜×•×¨×” ×××•×¦×¢×ª:</label>
                    <input type="range" id="temperature" min="1" max="10" value="5">
                    <span id="temperature-value" class="slider-value">5</span>
                     <p class="slider-tip">×›×œ ×¢×¥ ××•×”×‘ ×˜××¤×¨×˜×•×¨×” ××¡×•×™××ª. ×§×™×¦×•× ×™×•×ª (×—×•×/×§×•×¨) ×××˜×” ××ª ×”×’×“×™×œ×”.</p>
                </div>
                <div class="slider-group">
                    <label for="pests">ğŸ› × ×•×›×—×•×ª ××–×™×§×™×/××—×œ×•×ª:</label>
                    <input type="range" id="pests" min="1" max="10" value="1">
                    <span id="pests-value" class="slider-value">1</span>
                     <p class="slider-tip">××–×™×§×™× ×•××—×œ×•×ª ×’×•×–×œ×™× ××”×¢×¥ ×× ×¨×’×™×” ×•××—×œ×™×©×™× ××•×ª×•.</p>
                </div>
            </div>
            <div class="action-buttons">
                <button id="next-year-btn" class="btn-primary">×¡×™×™× ×©× ×” ×•×¦×¤×” ×‘×˜×‘×¢×ª</button>
                <button id="reset-btn" class="btn-secondary">×”×ª×—×œ ×¢×¥ ×—×“×©</button>
            </div>
        </div>

        <div class="visualization-area">
             <div class="canvas-container">
                 <canvas id="tree-canvas" width="400" height="400"></canvas>
                 <div class="canvas-overlay"></div> <!-- For subtle animation effects -->
             </div>
            <div class="history">
                <h4>×™×•××Ÿ ×’×“×™×œ×”:</h4>
                <ul id="year-history-list">
                    <li>×‘×—×¨ ×ª× ××™× ×œ×©× ×” ×”×¨××©×•× ×”...</li>
                </ul>
            </div>
        </div>
    </div>
     <div class="growth-summary" id="growth-summary"></div> <!-- Area for growth summary -->
</div>

<button id="toggle-explanation-btn" class="btn-toggle-explanation">×”×¦×’/×”×¡×ª×¨ ×”×¡×‘×¨ ×¢×œ ×˜×‘×¢×•×ª ×’×“×™×œ×”</button>

<div id="explanation" class="explanation-section hidden">
    <h2>×”×¡×‘×¨ ××¤×•×¨×˜: ××” ×”×¢×¥ ××¡×¤×¨ ×œ× ×• ×‘×˜×‘×¢×•×ª ×©×œ×•?</h2>

    <h3>××”×Ÿ ×˜×‘×¢×•×ª ×©× ×ª×™×•×ª ×•×›×™×¦×“ ×”×Ÿ × ×•×¦×¨×•×ª?</h3>
    <p>×˜×‘×¢×•×ª ×”×’×“×™×œ×”, ××• ×˜×‘×¢×•×ª ×©× ×ª×™×•×ª, ×”×Ÿ ×›××• ×“×¤×™× ×‘×™×•××Ÿ ×©×œ ×”×¢×¥. ×‘×›×œ ×¢×•× ×ª ×’×“×™×œ×” ×¤×¢×™×œ×”, ×”×¢×¥ ××•×¡×™×£ ×©×›×‘×” ×—×“×©×” ×©×œ ×¢×¦×” (×¨×§××” ×”××•×‘×™×œ×” ××™× ×•×ª×•××›×ª ×‘×¢×¥) ×¡×‘×™×‘ ×”×©×›×‘×•×ª ×”×™×©× ×•×ª ×™×•×ª×¨. ×›×©×—×•×ª×›×™× ×’×–×¢, ×”×©×›×‘×•×ª ×”××œ×• × ×¨××•×ª ×›×˜×‘×¢×•×ª ××¢×’×œ×™×•×ª.</p>
    <p>×‘××–×•×¨×™× ×¢× ×¢×•× ×•×ª ××•×‘×—× ×•×ª (×›××• ×§×™×¥/×—×•×¨×£ ××• ×¢×•× ×” ×™×‘×©×”/×¨×˜×•×‘×”), ×”×¢×¥ ×’×“×œ ×‘×§×¦×‘ ×©×•× ×” ×‘××”×œ×š ×”×©× ×”. ×”×’×“×™×œ×” ×”××”×™×¨×” ×™×•×ª×¨ (×‘×“×¨×š ×›×œ×œ ×‘××‘×™×‘/×ª×—×™×œ×ª ×”×¢×•× ×” ×”×¨×˜×•×‘×”) ×™×•×¦×¨×ª ×ª××™ ×¢×¦×” ×’×“×•×œ×™× ×•×‘×”×™×¨×™× ×™×•×ª×¨ (×¢×¥ ××‘×™×‘), ×•×”×’×“×™×œ×” ×”××™×˜×™×ª ×™×•×ª×¨ (×‘×§×™×¥/×œ×§×¨××ª ×¡×•×£ ×”×¢×•× ×” ×”×¨×˜×•×‘×”) ×™×•×¦×¨×ª ×ª××™ ×¢×¦×” ×§×˜× ×™× ×•×¦×¤×•×¤×™× ×™×•×ª×¨, ×”× ×¨××™× ×›×”×™× ×™×•×ª×¨ (×¢×¥ ×§×™×¥). ×”××¢×‘×¨ ×”×—×“ ×‘×™×Ÿ ×”'×¢×¥ ×”×›×”×”' ×©×œ ×©× ×” ××—×ª ×œ'×¢×¥ ×”×‘×”×™×¨' ×©×œ ×”×©× ×” ×©××—×¨×™×” ×™×•×¦×¨ ××ª ×”×’×‘×•×œ ×”×‘×¨×•×¨ ×©×œ ×”×˜×‘×¢×ª, ×•×××¤×©×¨ ×œ× ×• ×œ×¡×¤×•×¨ ×©× ×™×.</p>

    <h3>××‘× ×” ×”×’×–×¢: ×”×©×—×§× ×™× ×”×¨××©×™×™×</h3>
    <ul>
        <li><strong>×§××‘×™×•× (Cambium):</strong> ×©×›×‘×ª ×§×¡× ×“×§×”! × ××¦××ª ×‘×™×Ÿ ×”×¢×¦×” (×¤× ×™×) ×œ×©×™×¤×” (×—×•×¥). ×ª××™ ×”×§××‘×™×•× ××ª×—×œ×§×™× ×•×™×•×¦×¨×™× ×¢×¦×” ×—×“×©×” ×¤× ×™××” ×•×©×™×¤×” ×—×“×©×” ×”×—×•×¦×”, ×•×›×š ×”×¢×¥ ××ª×¨×—×‘.</li>
        <li><strong>×§×¡×™×œ× (Xylem - ×¢×¦×”):</strong> ×”"×©×œ×“" ×•××¢×¨×›×ª ×”"××™× ×¡×˜×œ×¦×™×”" ×©×œ ×”×¢×¥. ××•×‘×™×œ ××™× ×•××™× ×¨×œ×™× ××”×©×•×¨×©×™× ×œ××¢×œ×”, ×•××¡×¤×§ ×ª××™×›×”. ×–×” ×”×—×œ×§ ×©××× ×• ×¢×©×•×™×•×ª ×”×˜×‘×¢×•×ª ×”×©× ×ª×™×•×ª.</li>
        <li><strong>×¤×œ×•×× (Phloem - ×©×™×¤×”):</strong> ×”"×©×œ×™×—" ×©×œ ×”×¢×¥. ××•×‘×™×œ ×¡×•×›×¨×™× (×ª×•×¦×¨ ×”×¤×•×˜×•×¡×™× ×ª×–×” ×‘×¢×œ×™×) ×œ×©××¨ ×—×œ×§×™ ×”×¢×¥. ×××•×§× ×‘×—×•×¥, ×•××”×•×•×” ×—×œ×§ ××”×§×œ×™×¤×”.</li>
    </ul>

    <h3>×¡×™×¤×•×¨ ×‘×¨×•×—×‘ ×”×˜×‘×¢×ª: ××™×š ×ª× ××™ ×”×¡×‘×™×‘×” ××©×¤×™×¢×™×?</h3>
    <p>×¨×•×—×‘×” ×©×œ ×›×œ ×˜×‘×¢×ª ××¡×¤×¨ ×¡×™×¤×•×¨ ×¢×œ ×”×©× ×” ×©×‘×” × ×•×¦×¨×”:</p>
    <ul>
        <li><strong>××™× (××©×§×¢×™×):</strong> ×”×›×™ ×§×¨×™×˜×™! ×©× ×” ×’×©×•××” ×‘××™×•×—×“ = ×˜×‘×¢×ª ×¨×—×‘×”. ×©× ×ª ×‘×¦×•×¨×ª ×§×©×” = ×˜×‘×¢×ª ×“×§×™×§×” (××• ××¤×™×œ×• ×œ×œ× ×’×“×™×œ×” ×›×œ×œ).</li>
        <li><strong>××•×¨ ×©××©:</strong> ×“×œ×§ ×œ×¤×•×˜×•×¡×™× ×ª×–×”. ×”×¨×‘×” ×©××© (×‘×œ×™ ×”×¦×œ×œ×”) = ×™×™×¦×•×¨ ×¡×•×›×¨×™× ×’×‘×•×” = ×’×“×™×œ×” ×˜×•×‘×”.</li>
        <li><strong>×˜××¤×¨×˜×•×¨×”:</strong> ×˜××¤×¨×˜×•×¨×•×ª ××ª××™××•×ª ×××¤×©×¨×•×ª ×ª×”×œ×™×›×™× ×‘×™×•×œ×•×’×™×™× ×™×¢×™×œ×™×. ×—×•× ××• ×§×•×¨ ×§×™×¦×•× ×™×™× ×™×¢×¦×¨×• ××• ×™××˜×• ×’×“×™×œ×” ××©××¢×•×ª×™×ª.</li>
        <li><strong>××–×™×§×™× ×•××—×œ×•×ª:</strong> ×”×ª×§×¤×” ×§×©×” ××—×œ×™×©×” ××ª ×”×¢×¥, ×’×•×¨××ª ×œ×• "×œ×‘×–×‘×–" ×× ×¨×’×™×” ×¢×œ ×”×ª×’×•× × ×•×ª ×‘××§×•× ×¢×œ ×’×“×™×œ×”, ×•×”×˜×‘×¢×ª ×ª×”×™×” ×¦×¨×”.</li>
    </ul>
    <p>×˜×‘×¢×ª ×¨×—×‘×” ×”×™× ×¢×“×•×ª ×œ×©× ×” ×˜×•×‘×”, ×•×˜×‘×¢×ª ×¦×¨×” ×”×™× ×¢×“×•×ª ×œ×©× ×” ×§×©×”.</p>

    <h3>×‘×œ×©×™ ×”×¢×¦×™×: ×©×™××•×©×™× ××“×”×™××™× ×‘×˜×‘×¢×•×ª ×©× ×ª×™×•×ª</h3>
    <p>×—×§×¨ ×˜×‘×¢×•×ª ×”×¢×¥ × ×§×¨× ×“× ×“×¨×•×›×¨×•× ×•×œ×•×’×™×”. ××” ××¤×©×¨ ×œ×œ××•×“ ××× ×•?</p>
    <ul>
        <li><strong>×ª×™××¨×•×š ××“×•×™×§:</strong> ×¢×œ ×™×“×™ ×”×©×•×•××ª ×“×¤×•×¡×™ ×¨×•×—×‘ ×˜×‘×¢×•×ª ××¢×¦×™× ×©×•× ×™× (×—×™×™×, ××ª×™×, ×©×¨×™×“×™× ××¨×›×™××•×œ×•×’×™×™×), ××¤×©×¨ ×œ×ª××¨×š ×¢×¦×™× ××• ××‘× ×™ ×¢×¥ ×‘×“×™×•×§ ×©×œ ×©× ×” ×‘×•×“×“×ª!</li>
        <li><strong>×©×—×–×•×¨ ×¢×‘×¨ ×”××§×œ×™×:</strong> ××›×™×•×•×Ÿ ×©×¨×•×—×‘ ×”×˜×‘×¢×ª ××•×©×¤×¢ ×××§×œ×™×, ×“×¤×•×¡×™ ×˜×‘×¢×•×ª ××¢×¦×™× ×¢×ª×™×§×™× ×”× ×ª×™×¢×•×“ ××“×”×™× ×©×œ ×ª× ××™ ×”××§×œ×™× ×©×”×™×• ×œ×¤× ×™ ×××•×ª ×•××œ×¤×™ ×©× ×™×, ×”×¨×‘×” ×œ×¤× ×™ ×©×”×ª×—×œ× ×• ×œ××“×•×“ ××•×ª× ×‘××•×¤×Ÿ ×©×™×˜×ª×™. ×›×š ×œ×•××“×™× ×¢×œ ×ª×§×•×¤×•×ª ×‘×¦×•×¨×ª, ×’×©××™×, ×•×¢×•×“.</li>
        <li><strong>×ª×™×¢×•×“ ××™×¨×•×¢×™×:</strong> ×¦×œ×§×•×ª ××©×¨×™×¤×•×ª, ×¡×™×× ×™ ×›×¤×•×¨, ××• ×¢×™×•×•×ª×™× ×©× ×’×¨××• ×¢×œ ×™×“×™ ××–×™×§×™× ××• ×¤×¦×™×¢×•×ª ××—×¨×•×ª × ×©××¨×™× ×’× ×”× ×‘×˜×‘×¢×•×ª ×•××¡×¤×¨×™× ×¢×œ ××™×¨×•×¢×™× ×¡×¤×¦×™×¤×™×™× ×‘×—×™×™ ×”×¢×¥.</li>
    </ul>
</div>

<style>
:root {
    --color-primary: #4a90e2; /* Blue */
    --color-secondary: #f5a623; /* Orange */
    --color-text: #333;
    --color-bg-light: #f8f8f8;
    --color-bg-medium: #e0e0e0;
    --color-bg-dark: #c0c0c0;
    --color-ring-spring: #f0d9b5; /* Warm light brown */
    --color-ring-summer: #8b4513; /* Saddle Brown */
    --color-core: #5a3e2c; /* Darker core */
    --color-success: #7ed321; /* Green */
    --color-warning: #f8e71c; /* Yellow */
    --color-danger: #d0021b; /* Red */
    --border-radius: 8px;
    --box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
}

body {
     font-family: 'Arial Hebrew', 'Arial', sans-serif;
     direction: rtl;
     line-height: 1.6;
     color: var(--color-text);
     background-color: #f4f4f4;
     margin: 0;
     padding: 20px;
}

.app-container {
    background-color: #fff;
    max-width: 900px;
    margin: 20px auto;
    padding: 30px;
    border-radius: var(--border-radius);
    box-shadow: var(--box-shadow);
    text-align: right;
}

.app-header {
    text-align: center;
    margin-bottom: 20px;
    border-bottom: 2px solid var(--color-bg-medium);
    padding-bottom: 15px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.app-header h2 {
    color: var(--color-primary);
    margin: 0;
    font-size: 1.8em;
}

.year-info {
    font-size: 1.5em;
    color: var(--color-text);
    font-weight: bold;
}

.year-label {
    color: #666;
    font-size: 0.8em;
    font-weight: normal;
}

.year-number {
    color: var(--color-secondary);
    font-size: 1.2em;
}


.simulator-content {
    display: flex;
    flex-wrap: wrap;
    gap: 30px;
    justify-content: center;
}

.controls-panel {
    flex: 1 1 300px; /* Allows flex item to grow/shrink, basis 300px */
    background-color: var(--color-bg-light);
    padding: 20px;
    border-radius: var(--border-radius);
    box-shadow: inset 0 0 5px rgba(0,0,0,0.05);
    min-width: 300px;
}

.controls-panel h3 {
    text-align: center;
    margin-top: 0;
    color: var(--color-text);
    margin-bottom: 20px;
}

.condition-sliders .slider-group {
    margin-bottom: 25px;
    padding: 10px;
    background-color: #fff;
    border-radius: var(--border-radius);
    box-shadow: 0 2px 4px rgba(0,0,0,0.05);
}

.slider-group label {
    display: block;
    margin-bottom: 8px;
    font-weight: bold;
    color: var(--color-primary);
    font-size: 1em;
}

.slider-group input[type="range"] {
    width: calc(100% - 60px); /* Adjust width for value span */
    display: inline-block;
    vertical-align: middle;
    -webkit-appearance: none; /* Override default appearance */
    appearance: none;
    height: 8px;
    background: linear-gradient(to right, var(--color-danger) 0%, var(--color-warning) 30%, var(--color-success) 50%, var(--color-warning) 70%, var(--color-danger) 100%); /* Example gradient */
    background-size: 100% 100%;
    background-repeat: no-repeat;
    background-position: center;
    border-radius: 5px;
    outline: none;
    opacity: 0.7;
    transition: opacity .2s ease;
}

.slider-group input[type="range"]::-webkit-slider-thumb {
    -webkit-appearance: none;
    appearance: none;
    width: 20px;
    height: 20px;
    background: var(--color-primary);
    border: 2px solid #fff;
    border-radius: 50%;
    cursor: pointer;
    box-shadow: 0 2px 4px rgba(0,0,0,0.2);
    transition: background 0.3s ease;
}

.slider-group input[type="range"]::-moz-range-thumb {
    width: 20px;
    height: 20px;
    background: var(--color-primary);
    border: 2px solid #fff;
    border-radius: 50%;
    cursor: pointer;
    box-shadow: 0 2px 4px rgba(0,0,0,0.2);
    transition: background 0.3s ease;
}

.slider-group input[type="range"]:hover {
    opacity: 1;
}

.slider-group .slider-value {
     display: inline-block;
     width: 40px; /* Fixed width for value */
     text-align: center;
     font-weight: bold;
     color: var(--color-text);
     vertical-align: middle;
}

.slider-tip {
    font-size: 0.8em;
    color: #666;
    margin-top: 5px;
    text-align: right;
}

/* Specific gradient adjustments for sliders */
#precipitation::-webkit-slider-runnable-track { background: linear-gradient(to right, var(--color-danger) 0%, var(--color-warning) 20%, var(--color-success) 80%, var(--color-warning) 100%); }
#precipitation::-moz-range-track { background: linear-gradient(to right, var(--color-danger) 0%, var(--color-warning) 20%, var(--color-success) 80%, var(--color-warning) 100%); }

#sunlight::-webkit-slider-runnable-track { background: linear-gradient(to right, var(--color-danger) 0%, var(--color-warning) 20%, var(--color-success) 80%, var(--color-warning) 100%); }
#sunlight::-moz-range-track { background: linear-gradient(to right, var(--color-danger) 0%, var(--color-warning) 20%, var(--color-success) 80%, var(--color-warning) 100%); }

#temperature::-webkit-slider-runnable-track { background: linear-gradient(to right, var(--color-danger) 0%, var(--color-warning) 20%, var(--color-success) 50%, var(--color-warning) 80%, var(--color-danger) 100%); }
#temperature::-moz-range-track { background: linear-gradient(to right, var(--color-danger) 0%, var(--color-warning) 20%, var(--color-success) 50%, var(--color-warning) 80%, var(--color-danger) 100%); }

#pests::-webkit-slider-runnable-track { background: linear-gradient(to right, var(--color-success) 0%, var(--color-warning) 20%, var(--color-danger) 80%, var(--color-danger) 100%); }
#pests::-moz-range-track { background: linear-gradient(to right, var(--color-success) 0%, var(--color-warning) 20%, var(--color-danger) 80%, var(--color-danger) 100%); }


.action-buttons {
    text-align: center;
    margin-top: 20px;
}

button {
    padding: 12px 25px;
    margin: 8px;
    border: none;
    border-radius: 25px; /* Pill shape */
    cursor: pointer;
    font-size: 1em;
    font-weight: bold;
    transition: transform 0.2s ease-in-out, background-color 0.3s ease, box-shadow 0.3s ease;
    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
}

button:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 10px rgba(0,0,0,0.15);
}

button:active {
     transform: translateY(0);
     box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

button.btn-primary {
    background-color: var(--color-primary);
    color: white;
}

button.btn-primary:hover {
    background-color: #3a80d2;
}

button.btn-secondary {
    background-color: var(--color-bg-medium);
    color: var(--color-text);
}

button.btn-secondary:hover {
    background-color: var(--color-bg-dark);
}

button.btn-toggle-explanation {
     display: block;
     width: fit-content;
     margin: 20px auto;
     background-color: #eee;
     color: #333;
     border-radius: var(--border-radius);
     box-shadow: none;
     font-size: 0.9em;
}
button.btn-toggle-explanation:hover {
     background-color: #ddd;
     transform: none;
     box-shadow: none;
}


.visualization-area {
    flex: 1 1 400px; /* Canvas needs space */
    display: flex;
    flex-direction: column;
    align-items: center; /* Center canvas vertically */
    min-width: 400px;
}

.canvas-container {
    position: relative;
    width: 400px;
    height: 400px;
    margin-bottom: 20px;
}

#tree-canvas {
    display: block; /* Remove extra space below canvas */
    border: 2px solid var(--color-core);
    background-color: var(--color-bg-light);
    border-radius: 50%; /* Make it look like a log section */
    box-shadow: var(--box-shadow);
    position: absolute;
    top: 0;
    left: 0;
    animation: appearScale 0.5s ease-out; /* Subtle animation on load/reset */
    transform-origin: center;
}

@keyframes appearScale {
    from { transform: scale(0.8); opacity: 0.6; }
    to { transform: scale(1); opacity: 1; }
}

.canvas-overlay {
     position: absolute;
     top: 0;
     left: 0;
     width: 100%;
     height: 100%;
     border-radius: 50%;
     pointer-events: none; /* Allow clicks to pass through to canvas */
     box-shadow: inset 0 0 20px rgba(0,0,0,0.2); /* Inner shadow for depth */
}


.history {
    width: 100%; /* Take full width in flex container */
    max-height: 200px; /* Reduced height for better layout */
    overflow-y: auto;
    padding: 15px;
    border: 1px solid var(--color-bg-medium);
    border-radius: var(--border-radius);
    background-color: #fff;
    box-shadow: inset 0 0 5px rgba(0,0,0,0.05);
}

.history h4 {
    margin-top: 0;
    color: var(--color-text);
    border-bottom: 1px solid var(--color-bg-light);
    padding-bottom: 10px;
    margin-bottom: 10px;
    text-align: center;
}

.history ul {
    list-style: none;
    padding: 0;
    margin: 0;
}

.history li {
    margin-bottom: 10px;
    padding: 8px;
    border-bottom: 1px dashed var(--color-bg-medium);
    font-size: 0.9em;
    color: #555;
    transition: background-color 0.2s ease;
    border-radius: 4px;
}
.history li:last-child {
    border-bottom: none;
    margin-bottom: 0;
    padding-bottom: 0;
}
.history li:hover {
    background-color: var(--color-bg-light);
}

.history li strong {
    color: var(--color-primary);
}

.growth-summary {
    text-align: center;
    margin-top: 20px;
    padding: 15px;
    border-radius: var(--border-radius);
    background-color: var(--color-bg-light);
    min-height: 1.5em; /* Reserve space */
    color: var(--color-text);
    font-weight: bold;
}


.explanation-section {
    margin-top: 30px;
    padding: 25px;
    border: 1px solid var(--color-bg-medium);
    border-radius: var(--border-radius);
    background-color: #fff;
    box-shadow: var(--box-shadow);
}

.explanation-section h2 {
    color: var(--color-primary);
    border-bottom: 2px solid var(--color-bg-medium);
    padding-bottom: 12px;
    margin-bottom: 20px;
    text-align: center;
    font-size: 1.6em;
}
.explanation-section h3 {
    color: var(--color-secondary);
    margin-top: 25px;
    margin-bottom: 15px;
    font-size: 1.3em;
    border-bottom: 1px dotted var(--color-bg-light);
    padding-bottom: 5px;
}

.explanation-section p,
.explanation-section ul {
    margin-bottom: 15px;
}

.explanation-section p,
.explanation-section li {
    line-height: 1.7;
    color: var(--color-text);
}

.explanation-section ul {
    list-style: disc;
    padding-right: 20px;
}

.explanation-section li {
    margin-bottom: 10px;
}

.explanation-section li strong {
    color: var(--color-primary);
}


.hidden {
    display: none;
}

/* Responsive adjustments */
@media (max-width: 768px) {
    .app-container {
        padding: 20px;
    }
    .simulator-content {
        flex-direction: column;
        gap: 20px;
    }
     .controls-panel, .visualization-area {
         min-width: unset;
         width: 100%;
     }
    .app-header {
        flex-direction: column;
        gap: 10px;
    }
    .year-info {
        font-size: 1.2em;
    }

     .canvas-container {
         width: 100%;
         height: auto; /* Adjust height based on width */
         padding-bottom: 100%; /* Maintain aspect ratio */
         position: relative;
     }
    #tree-canvas, .canvas-overlay {
        width: 100%;
        height: 100%;
        position: absolute;
        top: 0;
        left: 0;
    }

    .history {
        max-height: 150px; /* Further reduce height on smaller screens */
    }
}

@media (max-width: 480px) {
    .app-header h2 {
        font-size: 1.5em;
    }
    button {
        width: 100%;
        margin: 5px 0;
    }
}

</style>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const canvas = document.getElementById('tree-canvas');
    const ctx = canvas.getContext('2d');
    const currentYearSpan = document.getElementById('current-year');
    const precipitationSlider = document.getElementById('precipitation');
    const sunlightSlider = document.getElementById('sunlight');
    const temperatureSlider = document.getElementById('temperature');
    const pestsSlider = document.getElementById('pests');
    const precipitationValueSpan = document.getElementById('precipitation-value');
    const sunlightValueSpan = document.getElementById('sunlight-value');
    const temperatureValueSpan = document.getElementById('temperature-value');
    const pestsValueSpan = document.getElementById('pests-value');
    const nextYearBtn = document.getElementById('next-year-btn');
    const resetBtn = document.getElementById('reset-btn');
    const yearHistoryList = document.getElementById('year-history-list');
    const toggleExplanationBtn = document.getElementById('toggle-explanation-btn');
    const explanationSection = document.getElementById('explanation');
    const growthSummaryDiv = document.getElementById('growth-summary');

    let currentYear = 0;
    let treeRings = []; // Array of {year, conditions, ringWidth, springWoodColor, summerWoodColor, ringSummary}
    const MAX_RADIUS = canvas.width / 2 * 0.9; // Max radius for the rings
    const CENTER_X = canvas.width / 2;
    const CENTER_Y = canvas.height / 2;
    const CORE_RADIUS = 15; // The initial 'pith' or core, slightly larger

    // Function to draw the tree rings
    function drawTree() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        // Draw pith/core
        ctx.fillStyle = varToHex('--color-core'); // Using CSS variable
        ctx.beginPath();
        ctx.arc(CENTER_X, CENTER_Y, CORE_RADIUS, 0, Math.PI * 2);
        ctx.fill();

        let currentRadius = CORE_RADIUS;

        // Draw rings from inside out
        treeRings.forEach(ring => {
            const totalRingThickness = ring.ringWidth; // Total width of this year's ring

            // Draw summerwood (darker, inner part of the ring)
            const summerWoodThickness = totalRingThickness * (1 - ring.springWoodRatio);
             if (summerWoodThickness > 0) {
                ctx.fillStyle = ring.summerWoodColor;
                ctx.beginPath();
                ctx.arc(CENTER_X, CENTER_Y, currentRadius + summerWoodThickness, 0, Math.PI * 2);
                ctx.arc(CENTER_X, CENTER_Y, currentRadius, 0, Math.PI * 2, true);
                ctx.fill();
            }
            currentRadius += summerWoodThickness;

            // Draw springwood (lighter, outer part of the ring)
            const springWoodThickness = totalRingThickness * ring.springWoodRatio;
             if (springWoodThickness > 0) {
                ctx.fillStyle = ring.springWoodColor;
                ctx.beginPath();
                ctx.arc(CENTER_X, CENTER_Y, currentRadius + springWoodThickness, 0, Math.PI * 2);
                ctx.arc(CENTER_X, CENTER_Y, currentRadius, 0, Math.PI * 2, true);
                ctx.fill();
             }
            currentRadius += springWoodThickness;
        });

         // Add a subtle border/line between rings for clarity (optional, can be removed if colors create enough contrast)
         currentRadius = CORE_RADIUS; // Reset radius
         ctx.strokeStyle = 'rgba(0,0,0,0.1)'; // Light separator line
         ctx.lineWidth = 0.5;
         treeRings.forEach(ring => {
             const totalRingThickness = ring.ringWidth;
             currentRadius += totalRingThickness; // Move to the outer edge of the current ring
             ctx.beginPath();
             ctx.arc(CENTER_X, CENTER_Y, currentRadius, 0, Math.PI * 2);
             ctx.stroke();
         });

        // Trigger animation on canvas
        canvas.style.animation = 'none'; // Reset animation
        canvas.offsetHeight; // Trigger reflow
        canvas.style.animation = 'appearScale 0.5s ease-out'; // Re-apply animation
    }

    // Function to calculate ring properties based on conditions
    function calculateRingProperties(conditions) {
        const { precipitation, sunlight, temperature, pests } = conditions;

        // Influence of factors on growth rate (0 to 1 scale, 10 is best/worst)
        // Precipitation: strong positive influence, non-linear (low precip is very bad)
        const precipFactor = Math.pow(precipitation / 10, 1.5); // Exponential effect for low values

        // Sunlight: positive influence
        const sunFactor = sunlight / 10;

        // Temperature: peaks around 5, drops off at extremes
        const tempFactor = 1 - Math.pow(Math.abs(temperature - 5) / 5, 2); // Quadratic drop-off

        // Pests: negative influence, non-linear (high pests are very bad)
        const pestFactor = 1 - Math.pow((pests - 1) / 9, 2); // Exponential effect for high values

        // Combine factors - treat precipitation and pests as potential bottlenecks
        // Growth is limited by the minimum of key resources (water, light, suitable temp) AND limited by damage (pests)
        let resourceFactor = Math.min(precipFactor, sunFactor, tempFactor); // Simplified bottleneck logic
        let growthFactor = resourceFactor * pestFactor;

        // Ensure minimum growth even in bad conditions, but severe conditions should significantly limit
        growthFactor = Math.max(0.01, growthFactor); // Absolute minimum

        // Calculate available space and base ring width
        const currentTotalRadius = CORE_RADIUS + treeRings.reduce((sum, r) => sum + r.ringWidth, 0);
        const remainingRadius = MAX_RADIUS - currentTotalRadius;
        const potentialMaxRing = remainingRadius / (30 - currentYear); // Heuristic to ensure space for future years

        let ringWidth = growthFactor * potentialMaxRing * 2; // Scale growth factor to a potential width

        // Cap ring width to prevent overflowing canvas quickly, but allow wide rings
        ringWidth = Math.min(ringWidth, MAX_RADIUS / 15); // Cap max width per year

        // Adjust springwood/summerwood ratio
        // Good conditions (high water/sun, moderate temp) favour springwood formation (larger, thinner cells)
        // Poor conditions (low water/sun, extreme temp) favour summerwood (smaller, thicker cells)
        let springWoodRatio = (precipFactor * 0.5 + sunFactor * 0.3 + (1 - Math.abs(temperature - 5)/5) * 0.2); // More weight on water
        springWoodRatio = Math.min(0.7, Math.max(0.3, springWoodRatio)); // Ratio between 30% and 70%

        // Colors - more yellow/light brown for springwood, darker brown for summerwood
        const baseSpringColor = varToHex('--color-ring-spring');
        const baseSummerColor = varToHex('--color-ring-summer');

        // Simple color variation based on ratio
        const springColor = interpolateColor(baseSpringColor, '#ffebcd', springWoodRatio); // Lighter towards higher ratio
        const summerColor = interpolateColor(baseSummerColor, '#654321', 1 - springWoodRatio); // Darker towards lower ratio

         // Determine growth summary
         let growthSummary = '';
         if (ringWidth < MAX_RADIUS / 60) {
             growthSummary = ' (×’×“×™×œ×” ×“×œ×” ×××•×“)';
         } else if (ringWidth < MAX_RADIUS / 40) {
             growthSummary = ' (×’×“×™×œ×” ××•×¢×˜×”)';
         } else if (ringWidth < MAX_RADIUS / 25) {
             growthSummary = ' (×’×“×™×œ×” ×××•×¦×¢×ª)';
         } else {
             growthSummary = ' (×’×“×™×œ×” ××©××¢×•×ª×™×ª!)';
         }


        return {
            ringWidth: ringWidth,
            springWoodRatio: springWoodRatio,
            springWoodColor: springColor,
            summerWoodColor: summerColor,
            ringSummary: growthSummary
        };
    }

    // Helper: Get CSS variable color
    function varToHex(variable) {
         const style = getComputedStyle(document.documentElement);
         return style.getPropertyValue(variable).trim();
    }

    // Helper function for color interpolation
    function interpolateColor(color1, color2, factor) {
        const c1 = hexToRgb(color1);
        const c2 = hexToRgb(color2);
        const result = c1.map((c, i) => Math.round(c + factor * (c2[i] - c)));
        return rgbToHex(result);
    }

    function hexToRgb(hex) {
        const bigint = parseInt(hex.slice(1), 16);
        const r = (bigint >> 16) & 255;
        const g = (bigint >> 8) & 255;
        const b = bigint & 255;
        return [r, g, b];
    }

    function rgbToHex(rgb) {
        return '#' + rgb.map(x => {
            const hex = x.toString(16);
            return hex.length === 1 ? '0' + hex : hex;
        }).join('');
    }


    // Function to advance to the next year
    function nextYear() {
        currentYear++;
        currentYearSpan.textContent = currentYear;

        const conditions = {
            precipitation: parseInt(precipitationSlider.value),
            sunlight: parseInt(sunlightSlider.value),
            temperature: parseInt(temperatureSlider.value),
            pests: parseInt(pestsSlider.value)
        };

        // Check if we have enough space to grow another ring
        const currentTotalRadius = CORE_RADIUS + treeRings.reduce((sum, r) => sum + r.ringWidth, 0);
        if (currentTotalRadius >= MAX_RADIUS - 5) { // Add a small buffer
             const finalSummary = `×”×¢×¥ ×”×’×™×¢ ×œ×’×•×“×œ ×”××§×¡×™××œ×™ ×‘×¡×™××•×œ×¦×™×” ×–×• ×œ××—×¨ ${currentYear -1} ×©× ×™×! ×”×ª×—×œ ×¢×¥ ×—×“×© ×›×“×™ ×œ× ×¡×•×ª ×ª× ××™× ××—×¨×™×.`;
             growthSummaryDiv.textContent = finalSummary;
             growthSummaryDiv.style.color = varToHex('--color-primary');
             nextYearBtn.disabled = true; // Disable button
             return;
        }

        const ringProperties = calculateRingProperties(conditions);

        treeRings.push({
            year: currentYear,
            conditions: conditions,
            ...ringProperties // Spread ring properties
        });

        drawTree();
        updateHistory(currentYear, conditions, ringProperties);
        updateGrowthSummary(ringProperties);

        // Reset sliders to default (average) for the next year, or maybe keep them?
        // Let's keep them so user can tweak from current year's settings.
        // resetSliders(); // Optional: uncomment to reset sliders each year
    }

    // Function to reset the simulation
    function resetSimulation() {
        currentYear = 0;
        treeRings = [];
        currentYearSpan.textContent = currentYear;
        growthSummaryDiv.textContent = ''; // Clear summary
        growthSummaryDiv.style.color = varToHex('--color-text'); // Reset color
        drawTree(); // Draw initial empty state (just core)
        resetSliders();
        resetHistory();
        nextYearBtn.disabled = false; // Enable button
    }

    // Reset sliders to default value
    function resetSliders() {
         precipitationSlider.value = 5;
         sunlightSlider.value = 5;
         temperatureSlider.value = 5;
         pestsSlider.value = 1; // Pests default to low
         updateSliderValues();
    }

    // Update slider value displays
    function updateSliderValues() {
        precipitationValueSpan.textContent = precipitationSlider.value;
        sunlightValueSpan.textContent = sunlightSlider.value;
        temperatureValueSpan.textContent = temperatureSlider.value;
        pestsValueSpan.textContent = pestsSlider.value;
    }

    // Update history list
    function updateHistory(year, conditions, ringProperties) {
        if (year === 1) {
            yearHistoryList.innerHTML = ''; // Clear initial state
        }
        const listItem = document.createElement('li');
         const conditionsText = `×’×©×: ${conditions.precipitation}/10, ×©××©: ${conditions.sunlight}/10, ×˜××¤': ${conditions.temperature}/10, ××–×™×§×™×: ${conditions.pests}/10`;
        listItem.innerHTML = `
            <strong>×©× ×” ${year}:</strong> ${conditionsText} ${ringProperties.ringSummary}
        `;
        yearHistoryList.appendChild(listItem);
        yearHistoryList.scrollTop = yearHistoryList.scrollHeight; // Scroll to bottom
    }

    // Update growth summary text
    function updateGrowthSummary(ringProperties) {
        let summaryText = `<strong>×‘×©× ×” ${currentYear}</strong>: ×’×“×™×œ×ª ×”×˜×‘×¢×ª ×”×™×™×ª×” ${ringProperties.ringSummary.replace(/[()]/g, '').trim()}.`;
        if (ringProperties.ringSummary.includes('××©××¢×•×ª×™×ª')) {
             growthSummaryDiv.style.color = varToHex('--color-success');
        } else if (ringProperties.ringSummary.includes('×“×œ×”')) {
            growthSummaryDiv.style.color = varToHex('--color-danger');
        } else {
             growthSummaryDiv.style.color = varToHex('--color-text');
        }
         growthSummaryDiv.innerHTML = summaryText;
    }


    // Reset history list
    function resetHistory() {
        yearHistoryList.innerHTML = '<li>×‘×—×¨ ×ª× ××™× ×œ×©× ×” ×”×¨××©×•× ×”...</li>';
    }


    // Event listeners
    nextYearBtn.addEventListener('click', nextYear);
    resetBtn.addEventListener('click', resetSimulation);

    precipitationSlider.addEventListener('input', updateSliderValues);
    sunlightSlider.addEventListener('input', updateSliderValues);
    temperatureSlider.addEventListener('input', updateSliderValues);
    pestsSlider.addEventListener('input', updateSliderValues);

    toggleExplanationBtn.addEventListener('click', () => {
        const isHidden = explanationSection.classList.contains('hidden');
        explanationSection.classList.toggle('hidden', !isHidden); // Toggle hidden class
        toggleExplanationBtn.textContent = isHidden ? '×”×¡×ª×¨ ×”×¡×‘×¨' : '×”×¦×’/×”×¡×ª×¨ ×”×¡×‘×¨ ×¢×œ ×˜×‘×¢×•×ª ×’×“×™×œ×”';
    });

    // Initial setup
    resetSimulation(); // Start in the initial state
});
</script>
---