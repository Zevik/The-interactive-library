---
title: "חיבור עולמות: מסדרונות אקולוגיים"
english_slug: connecting-worlds-ecological-corridors
category: "אקולוגיה"
tags: [אקולוגיה, שימור טבע, מגוון ביולוגי, בתי גידול, קישוריות נופית]
---
<div class="intro-section">
    <h1>חיבור עולמות: מסדרונות אקולוגיים</h1>
    <p>העולם שלנו מתפצל. שטחי טבע הופכים לאיים קטנים מוקפים בים של פיתוח אנושי, לוכדים בתוכם יצורים חיים. איך נוכל לגשר על הפער, לאפשר לחיות לנוע בחופשיות, ולשמור על עתיד המינים?</p>
    <p class="mission-intro">צא למשימה אקולוגית קריטית!</p>
</div>

<div class="app-container">
    <h2>בנה את מסדרון החיים</h2>
    <p>מטרתך: צור נתיב בטוח ואפקטיבי שמחבר את שמורת הטבע העליונה (מסומנת ב-R) לשמורה התחתונה. עמוד במגבלת התקציב! לחץ על אריחי המפה כדי לבחור אותם למסדרון שלך. כל שטח נוף שונה בעלותו וביכולת שלו לתמוך בתנועת בעלי חיים (אפקטיביות).</p>

    <div class="map-grid" id="ecologicalMap">
        <!-- Map cells will be generated by JS -->
    </div>

    <div class="controls-and-stats">
        <div class="stats-box">
            <div class="stat-item">תקציב התחלתי: <span id="initialBudget">100</span> ש"ח אקולוגיים</div>
            <div class="stat-item">תקציב נותר: <span id="currentBudget">100</span> ש"ח אקולוגיים</div>
            <div class="stat-item">עלות המסדרון: <span id="corridorCost">0</span> ש"ח אקולוגיים</div>
            <div class="stat-item">אפקטיביות המסדרון: <span id="corridorEffectiveness">0</span> נקודות</div>
        </div>
        <div class="action-buttons">
            <button id="clearCorridorBtn" class="action-button clear-button">נקה מסדרון</button>
            <button id="evaluateCorridorBtn" class="action-button evaluate-button">הערך מסדרון</button>
        </div>
    </div>

    <div class="message-box" id="messageBox"></div>

    <div class="legend">
        <h4>מקרא הנוף:</h4>
        <div class="legend-items">
            <div class="legend-item"><span class="cell-icon reserve">R</span> שמורת טבע (נקודות התחלה/סיום)</div>
            <div class="legend-item"><span class="cell-icon open-nature"></span> שטח פתוח טבעי (עלות: 3, אפקטיביות: 9) - אידיאלי!</div>
            <div class="legend-item"><span class="cell-icon forest"></span> יער (עלות: 5, אפקטיביות: 8)</div>
            <div class="legend-item"><span class="cell-icon agriculture"></span> שטח חקלאי (עלות: 7, אפקטיביות: 6)</div>
            <div class="legend-item"><span class="cell-icon road"></span> כביש (עלות: 10, אפקטיביות: 3) - מכשול!</div>
            <div class="legend-item"><span class="cell-icon built"></span> שטח בנוי (עלות: 15, אפקטיביות: 1) - להימנע!</div>
        </div>
    </div>

</div>

<button id="toggleExplanationBtn" class="action-button explanation-button">הצג/הסתר הסבר</button>

<div class="explanation" id="explanationContent" style="display: none;">
    <h2>מסדרונות אקולוגיים: מעבר בטוח לעולם מקוטע</h2>

    <h3>למה בכלל צריך מסדרונות? הכירו את "פרגמנטציה"</h3>
    <p>דמיינו אוכלוסיית בעלי חיים קטנה שנותרת לכודה ב"אי" יער קטן, כי כל מה שמסביב נהפך לשדות ובניינים. הם לא יכולים להגיע למקורות מזון או מים אחרים, למצוא בני זוג מחוץ לקבוצה שלהם (מה שפוגע במגוון הגנטי), או לברוח מאסון מקומי כמו שריפה. התופעה הזו, בה שטחי טבע מתפצלים ומתכווצים, נקראת <strong>פרגמנטציה של בתי גידול</strong>, והיא אחד האיומים הגדולים על המגוון הביולוגי.</p>

    <h3>הפתרון: לגשר על הפערים</h3>
    <p><strong>מסדרונות אקולוגיים</strong> הם נתיבים או רצועות של בתי גידול טבעיים או משוקמים, שמחברים בין שטחי טבע מבודדים. הם כמו "גשרים ירוקים" או "דרכים בטוחות" המאפשרים לאורגניזמים (מבעלי חיים גדולים ועד חרקים וצמחים) לנוע בין "האיים" האלה. התנועה הזו חיונית כדי:</p>
    <ul>
        <li>לשמור על אוכלוסיות גדולות ובריאות יותר.</li>
        <li>להבטיח מגוון גנטי ולהפחית סכנת הכחדה מקומית.</li>
        <li>לאפשר גישה למשאבים חיוניים (מזון, מים).</li>
        <li>לעזור למינים להגיב לשינויים סביבתיים, כולל שינויי אקלים (ע"י מעבר לאזורים מתאימים יותר).</li>
        <li>לשמר תהליכים אקולוגיים חיוניים כמו האבקה והפצת זרעים.</li>
    </ul>

    <h3>לא כל מסדרון נולד שווה: סוגים ושיקולי תכנון</h3>
    <p>מסדרונות יכולים להיות פשוטים (רצועת יער צרה) או מורכבים (רשת של שטחים שונים). ההצלחה שלהם תלויה בתכנון חכם:</p>
    <ul>
        <li><strong>רוחב ועורך:</strong> רצועה רחבה וקצרה יחסית בטוחה יותר ויכולה לתמוך ביותר מינים.</li>
        <li><strong>איכות בית הגידול:</strong> המסדרון צריך לספק סביבה מתאימה למעבר, אכילה ואפילו רבייה לחלק מהמינים.</li>
        <li><strong>מיקום אסטרטגי:</strong> חיבור הנקודות הנכונות, הימנעות ממכשולים קריטיים (כבישים סואנים, אזורים בנויים לחלוטין) ומעבר בשטחים שקל יחסית לשקם או לשמר.</li>
        <li><strong>רציפות:</strong> חשוב שלא יהיו "צווארי בקבוק" קטלניים בדרך.</li>
    </ul>
    <p>המודל האינטראקטיבי ששיחקתם איתו מדמה באופן פשטני את המורכבות הזו - כל שטח נוף שונה בעלות "הקמה" (או שיקום/הגנה) שלו ובמידת הסיכון או הקושי שהוא מציב עבור תנועה (האפקטיביות שלו).</p>

    <h3>האתגרים הגדולים</h3>
    <p>בניית מסדרונות אקולוגיים אינה פשוטה: היא יקרה (רכישת קרקעות, שיקום), דורשת תיאום עם תכנון אנושי קיים, ומצריכה תחזוקה מתמדת. ובכל זאת, מול קצב הפיתוח המודרני, הם הפכו לכלי הכרחי בשמירה על עולם טבע חי ומקושר.</p>
</div>

<style>
    /* גופנים ואסתטיקה בסיסית */
    body {
        font-family: 'Arial Hebrew', 'Arial', sans-serif; /* עדיפות לעברית, גיבוי לאנגלית */
        line-height: 1.7; /* רווח שורות נעים יותר */
        margin: 0;
        padding: 20px;
        direction: rtl; /* יישור מימין לשמאל */
        text-align: right;
        background-color: #eef5eb; /* רקע עדין */
        color: #333;
    }

    h1, h2, h3, h4 {
        color: #215e21; /* גוון ירוק כהה */
        margin-bottom: 15px;
        line-height: 1.4;
    }

    h1 { font-size: 2em; }
    h2 { font-size: 1.6em; }
    h3 { font-size: 1.3em; }
    h4 { font-size: 1.1em; }

    p {
        margin-bottom: 15px;
    }

    .intro-section {
        background-color: #ffffff;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 4px 8px rgba(0,0,0,0.05);
        margin-bottom: 30px;
        border-top: 5px solid #4CAF50; /* פס צבעוני למעלה */
    }

    .mission-intro {
        font-size: 1.2em;
        font-weight: bold;
        color: #4CAF50;
        text-align: center; /* מרכז טקסט המשימה */
        margin-top: 20px;
    }

    /* סגנון האפליקציה האינטראקטיבית */
    .app-container {
        margin-top: 30px;
        padding: 30px;
        border: 1px solid #c8e6c9; /* מסגרת עדינה */
        border-radius: 10px;
        background-color: #ffffff;
        box-shadow: 0 4px 8px rgba(0,0,0,0.05);
        text-align: right;
    }

    .map-grid {
        display: grid;
        grid-template-columns: repeat(10, 40px); /* 10 עמודות */
        grid-template-rows: repeat(10, 40px);    /* 10 שורות */
        gap: 3px; /* מרווח גדול יותר בין תאים */
        border: 2px solid #215e21; /* מסגרת מפה ברורה */
        margin: 30px auto; /* ממורכז עם מרווח */
        width: fit-content; /* מתאים את רוחב הקונטיינר למפה */
        box-shadow: 2px 2px 8px rgba(0,0,0,0.1);
    }

    .grid-cell {
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 14px; /* גודל טקסט גדול יותר */
        font-weight: bold;
        cursor: pointer;
        border: 1px solid #a5d6a7; /* גבול ברירת מחדל */
        box-sizing: border-box;
        transition: all 0.2s ease-in-out; /* אנימציית מעבר חלקה */
        position: relative; /* עבור אנימציות/שכבות */
        overflow: hidden; /* לוודא שאנימציות לא חורגות */
    }

    .grid-cell:hover:not(.reserve) { /* הבהרה במעבר עכבר, לא בשמורות */
        border-color: #215e21;
        box-shadow: 0 0 8px rgba(33, 94, 33, 0.5);
        z-index: 1; /* הקפצה קלה בשכבה */
    }

    /* צבעי שטחי הנוף */
    .grid-cell.forest { background-color: #66bb6a; } /* Green */
    .grid-cell.open-nature { background-color: #aed581; } /* Light Green */
    .grid-cell.agriculture { background-color: #fff176; } /* Yellow */
    .grid-cell.road { background-color: #90a4ae; } /* Blue Grey */
    .grid-cell.built { background-color: #bdbdbd; } /* Grey */
    .grid-cell.reserve {
        background-color: #42a5f5; /* Blue */
        color: white;
        font-size: 1.5em; /* R גדולה יותר */
        cursor: default; /* לא ניתן ללחוץ על שמורות */
        border: 2px solid #1565c0;
        box-shadow: 0 0 10px rgba(66, 165, 245, 0.7);
    }


    /* סגנון תא במסדרון */
    .grid-cell.corridor {
        border: 3px solid #673ab7; /* סגול בולט */
        box-shadow: 0 0 10px #673ab7; /* צל סגול */
        transform: scale(1.05); /* הגדלה קלה באנימציה */
        z-index: 2; /* מעל תאים רגילים */
        animation: pulse 0.8s ease-out; /* אנימציית פעימה בעת הוספה */
    }

     @keyframes pulse {
         0% { transform: scale(1); }
         50% { transform: scale(1.08); }
         100% { transform: scale(1.05); }
     }

    /* אזור בקרה וסטטיסטיקה */
    .controls-and-stats {
        display: flex;
        justify-content: space-between;
        align-items: flex-start; /* יישור לראש הקונטיינר */
        flex-wrap: wrap; /* גלישת פריטים למטה במקרה הצורך */
        gap: 20px; /* מרווח בין הסטטיסטיקות לכפתורים */
        margin-top: 20px;
        padding-top: 20px;
        border-top: 1px solid #e0e0e0; /* קו הפרדה עדין */
    }

    .stats-box {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); /* עמודות גמישות */
        gap: 15px; /* מרווח בין פריטי הסטטיסטיקה */
        flex-grow: 1; /* מאפשר לסטטיסטיקה לתפוס מקום */
    }

    .stat-item {
        font-size: 1em;
        background-color: #e8f5e9; /* רקע בהיר לפריט סטט */
        padding: 10px 15px;
        border-radius: 5px;
        border: 1px solid #c8e6c9;
    }

    .stat-item span {
        font-weight: bold;
        color: #1b5e20; /* צבע בולט למספרים */
    }

    .action-buttons {
         display: flex;
         gap: 15px; /* מרווח בין כפתורים */
         align-items: center; /* יישור כפתורים */
    }

    /* סגנון כפתורים כללי */
    button.action-button {
        padding: 12px 20px; /* ריווח גדול יותר בכפתורים */
        color: white;
        border: none;
        border-radius: 6px; /* פינות מעוגלות יותר */
        cursor: pointer;
        font-size: 1.1em;
        transition: background-color 0.3s ease, transform 0.1s ease; /* אנימציות במעבר עכבר ולחיצה */
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    button.action-button:hover {
        box-shadow: 0 4px 8px rgba(0,0,0,0.15);
    }

     button.action-button:active {
        transform: scale(0.98); /* אנימציית לחיצה */
     }

    .evaluate-button {
         background-color: #4CAF50; /* ירוק */
    }
    .evaluate-button:hover {
        background-color: #388E3C; /* ירוק כהה יותר */
    }

    .clear-button {
        background-color: #f44336; /* אדום */
    }
     .clear-button:hover {
        background-color: #d32f2f; /* אדום כהה יותר */
     }

    .explanation-button {
        margin-top: 30px;
        background-color: #03a9f4; /* כחול בהיר */
        display: block; /* כפתור ההסבר בשורה משלו */
        width: fit-content; /* מתאים את רוחב הכפתור לטקסט */
        margin-left: auto; /* ממקם את הכפתור בצד שמאל (בגלל RTL) */
        margin-right: auto; /* ממקם את הכפתור בצד ימין (בגלל RTL) */
    }
     .explanation-button:hover {
        background-color: #0288d1; /* כחול כהה יותר */
     }


    /* סגנון המקרא */
    .legend {
        margin-top: 30px;
        border-top: 1px solid #e0e0e0;
        padding-top: 20px;
    }

    .legend h4 {
        margin-top: 0;
        margin-bottom: 15px;
        color: #215e21;
    }
    .legend-items {
        display: flex;
        flex-wrap: wrap; /* גלישת פריטי מקרא */
        gap: 15px 25px; /* מרווח בין פריטי מקרא */
    }

    .legend-item {
        display: flex;
        align-items: center;
        font-size: 0.95em;
        color: #555;
    }

    .legend-item .cell-icon {
        display: inline-block;
        width: 25px; /* אייקון גדול יותר */
        height: 25px; /* אייקון גדול יותר */
        margin-left: 10px; /* מרווח מהטקסט */
        border: 1px solid #ccc;
        box-sizing: border-box;
        vertical-align: middle;
        border-radius: 4px; /* פינות מעוגלות לאייקון */
    }

    .legend-item .cell-icon.reserve {
        background-color: #42a5f5;
        color: white;
        text-align: center;
        line-height: 25px; /* ממורכז אנכית */
        font-size: 12px;
        font-weight: bold;
        border-color: #1565c0;
    }
    .legend-item .cell-icon.forest { background-color: #66bb6a; border-color: #388e3c;}
    .legend-item .cell-icon.open-nature { background-color: #aed581; border-color: #827717;}
    .legend-item .cell-icon.agriculture { background-color: #fff176; border-color: #fbc02d;}
    .legend-item .cell-icon.road { background-color: #90a4ae; border-color: #546e7a;}
    .legend-item .cell-icon.built { background-color: #bdbdbd; border-color: #757575;}


    /* תיבת הודעות */
    .message-box {
        margin-top: 25px;
        padding: 15px; /* ריווח פנימי */
        border: 1px solid;
        border-radius: 8px; /* פינות מעוגלות */
        min-height: 1.5em; /* גובה מינימלי */
        opacity: 1; /* ברירת מחדל גלוי */
        transition: opacity 0.5s ease-in-out; /* אנימציית הופעה/היעלמות */
        text-align: center; /* מרכז את הטקסט */
        font-weight: bold;
    }

     /* סגנונות שונים להודעות */
    .message-box.success {
        background-color: #e8f5e9; /* ירוק בהיר */
        color: #1b5e20; /* ירוק כהה */
        border-color: #c8e6c9; /* ירוק עדין */
    }
    .message-box.warning {
         background-color: #fffde7; /* צהוב בהיר */
         color: #fbc02d; /* צהוב כתום */
         border-color: #fff9c4; /* צהוב עדין */
    }
    .message-box.error {
        background-color: #ffebee; /* אדום בהיר */
        color: #c62828; /* אדום כהה */
        border-color: #ffcdd2; /* אדום עדין */
    }
     .message-box.info {
         background-color: #e1f5fe; /* כחול בהיר */
         color: #0277bd; /* כחול כהה */
         border-color: #b3e5fc; /* כחול עדין */
     }


    /* סגנון ההסבר */
    .explanation {
        margin-top: 30px;
        padding: 30px;
        border: 1px solid #c8e6c9;
        border-radius: 10px;
        background-color: #ffffff;
        box-shadow: 0 4px 8px rgba(0,0,0,0.05);
        text-align: right;
    }

    .explanation ul {
        padding-right: 20px; /* ריווח לרשימות */
    }

     .explanation li {
         margin-bottom: 10px; /* רווח בין פריטי רשימה */
     }

</style>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const mapGridElement = document.getElementById('ecologicalMap');
        const initialBudgetSpan = document.getElementById('initialBudget');
        const currentBudgetSpan = document.getElementById('currentBudget');
        const corridorCostSpan = document.getElementById('corridorCost');
        const corridorEffectivenessSpan = document.getElementById('corridorEffectiveness');
        const clearCorridorBtn = document.getElementById('clearCorridorBtn');
        const evaluateCorridorBtn = document.getElementById('evaluateCorridorBtn');
        const messageBox = document.getElementById('messageBox');
        const toggleExplanationBtn = document.getElementById('toggleExplanationBtn');
        const explanationContent = document.getElementById('explanationContent');

        const mapData = [
            ['R', 'O', 'O', 'F', 'F', 'F', 'F', 'O', 'O', 'O'],
            ['O', 'O', 'A', 'A', 'F', 'F', 'O', 'O', 'O', 'D'],
            ['A', 'A', 'A', 'F', 'F', 'O', 'O', 'D', 'D', 'D'],
            ['A', 'A', 'F', 'F', 'B', 'B', 'D', 'D', 'D', 'D'],
            ['O', 'O', 'O', 'F', 'B', 'B', 'B', 'B', 'B', 'D'],
            ['F', 'F', 'F', 'F', 'B', 'B', 'B', 'B', 'B', 'O'],
            ['F', 'F', 'O', 'O', 'O', 'B', 'B', 'B', 'O', 'R'],
            ['O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O'],
            ['O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O'],
            ['F', 'F', 'F', 'F', 'O', 'O', 'O', 'O', 'O', 'O']
        ];

        const terrainProperties = {
            'R': { cost: 0, effectiveness: 0, name: 'שמורת טבע', class: 'reserve' },
            'F': { cost: 5, effectiveness: 8, name: 'יער', class: 'forest' },
            'O': { cost: 3, effectiveness: 9, name: 'שטח פתוח טבעי', class: 'open-nature' },
            'A': { cost: 7, effectiveness: 6, name: 'שטח חקלאי', class: 'agriculture' },
            'D': { cost: 10, effectiveness: 3, name: 'כביש', class: 'road' },
            'B': { cost: 15, effectiveness: 1, name: 'שטח בנוי', class: 'built' }
        };

        const initialBudget = 100;
        let currentBudget = initialBudget;
        let corridorCells = [];
        // The reserves are fixed points but not part of the buildable corridor itself
        const startReserve = { row: 0, col: 0 };
        const endReserve = { row: 6, col: 9 };
        const GRID_SIZE = 10; // Assuming a square grid


        function renderMap() {
            mapGridElement.innerHTML = ''; // Clear previous map
            mapData.forEach((row, rIndex) => {
                row.forEach((cellType, cIndex) => {
                    const cell = document.createElement('div');
                    cell.classList.add('grid-cell');
                    cell.classList.add(terrainProperties[cellType].class);
                    cell.dataset.row = rIndex;
                    cell.dataset.col = cIndex;
                    // Add identifiers for reserves
                    if (rIndex === startReserve.row && cIndex === startReserve.col) {
                         cell.textContent = 'R';
                         cell.dataset.reserve = 'start';
                    } else if (rIndex === endReserve.row && cIndex === endReserve.col) {
                         cell.textContent = 'R';
                         cell.dataset.reserve = 'end';
                    } else {
                         // Only make non-reserve cells clickable
                         cell.addEventListener('click', handleCellClick);
                    }
                    mapGridElement.appendChild(cell);
                });
            });
            updateStats();
        }

        function handleCellClick(event) {
            const cell = event.target;
            const row = parseInt(cell.dataset.row);
            const col = parseInt(cell.dataset.col);
            const cellType = mapData[row][col];

            // Prevent selecting cells that are already part of the corridor
             if (corridorCells.some(c => c.row === row && c.col === col)) {
                 showMessage("התא הזה כבר חלק מהמסדרון.", 'warning');
                 return;
             }

             // Check adjacency: must be adjacent to the start reserve OR any existing corridor cell
            const isAdjacentToStart = isAdjacent(row, col, startReserve.row, startReserve.col);
            const isAdjacentToCorridor = corridorCells.some(corridorCell => isAdjacent(row, col, corridorCell.row, corridorCell.col));

             if (!isAdjacentToStart && !isAdjacentToCorridor) {
                 showMessage("המסדרון חייב להיות רציף. בחר תא שנוגע בשמורת המוצא (R עליונה) או באחד התאים שכבר בחרת.", 'warning');
                 // Optional: Add a temporary visual feedback on the cell like a shake or red border
                  cell.style.animation = 'shake 0.3s';
                  cell.addEventListener('animationend', () => { cell.style.animation = ''; });
                 return;
             }


            const cellCost = terrainProperties[cellType].cost;

            if (currentBudget >= cellCost) {
                currentBudget -= cellCost;
                corridorCells.push({ row, col, type: cellType });
                cell.classList.add('corridor');
                updateStats();
                 // showMessage(`נוסף: ${terrainProperties[cellType].name}. עלות: ${cellCost}.`, 'success'); // Too noisy?
                 showMessage("תא נוסף למסדרון.", 'success');

            } else {
                showMessage(`אין מספיק תקציב (${currentBudget} נותר) כדי לבחור את התא הזה (${terrainProperties[cellType].name}, עלות: ${cellCost}).`, 'error');
                 // Optional: Add a temporary visual feedback on the cell like a shake or red border
                 cell.style.animation = 'shake 0.3s';
                 cell.addEventListener('animationend', () => { cell.style.animation = ''; });
            }
        }

         @keyframes shake {
             0% { transform: translateX(0); }
             25% { transform: translateX(-5px); }
             50% { transform: translateX(5px); }
             75% { transform: translateX(-5px); }
             100% { transform: translateX(0); }
         }


        function isAdjacent(r1, c1, r2, c2) {
             // Checks for orthogonal adjacency (up, down, left, right)
            return Math.abs(r1 - r2) + Math.abs(c1 - c2) === 1;
        }


        function calculateCorridorStats() {
            let cost = 0;
            let effectiveness = 0;
            corridorCells.forEach(cell => {
                cost += terrainProperties[cell.type].cost;
                effectiveness += terrainProperties[cell.type].effectiveness;
            });
            return { cost, effectiveness };
        }

        function updateStats() {
            const stats = calculateCorridorStats();
            // Add animation/transition to stat updates
            animateStatUpdate(currentBudgetSpan, currentBudget);
            animateStatUpdate(corridorCostSpan, stats.cost);
            animateStatUpdate(corridorEffectivenessSpan, stats.effectiveness);
        }

         function animateStatUpdate(element, newValue) {
             // Simple animation: change color briefly
             const oldValue = parseInt(element.textContent) || 0;
             element.textContent = newValue; // Update the value immediately
             if (newValue !== oldValue) {
                 element.style.color = (newValue > oldValue) ? '#c62828' : '#1b5e20'; // Red for increase (cost/effectiveness), Green for decrease (budget)
                 // Special case: Budget decrease is expected, Cost/Effectiveness increase is expected.
                 // Let's make Budget decrease red, Cost increase red, Effectiveness increase green.
                  if (element === currentBudgetSpan) {
                      element.style.color = (newValue < oldValue) ? '#c62828' : '#1b5e20'; // Red on decrease
                  } else if (element === corridorCostSpan) {
                      element.style.color = (newValue > oldValue) ? '#c62828' : '#1b5e20'; // Red on increase
                  } else if (element === corridorEffectivenessSpan) {
                       element.style.color = (newValue > oldValue) ? '#1b5e20' : '#c62828'; // Green on increase
                  }


                 element.style.transition = 'color 0.3s ease';
                 setTimeout(() => {
                     element.style.color = '#1b5e20'; // Return to default color
                     element.style.transition = ''; // Remove transition after animation
                 }, 500);
             }
         }


        function clearCorridor() {
            corridorCells.forEach(cell => {
                const element = mapGridElement.querySelector(`[data-row='${cell.row}'][data-col='${cell.col}']`);
                if (element) {
                    element.classList.remove('corridor');
                     element.style.animation = ''; // Clear any shake animation
                     element.style.transform = ''; // Clear any scale animation
                }
            });
            corridorCells = [];
            currentBudget = initialBudget;
            updateStats();
            showMessage("המסדרון נוקה. התחל לבנות נתיב חדש מ-R ל-R.", 'info');
        }

        function evaluateCorridor() {
            const stats = calculateCorridorStats();
            const lastCell = corridorCells[corridorCells.length - 1];
            let message = "";
            let messageType = 'info';

            // Check if the corridor is connected to the start reserve
            const isConnectedToStart = corridorCells.length > 0 && corridorCells.some(cell => isAdjacent(cell.row, cell.col, startReserve.row, startReserve.col));

             // Check if the corridor reaches the end reserve
             const reachesEnd = corridorCells.some(cell => isAdjacent(cell.row, cell.col, endReserve.row, endReserve.col));


            if (corridorCells.length === 0) {
                message = "עוד לא בנית שום חלק במסדרון! לחץ על תאים סביב שמורת המוצא (R עליונה) כדי להתחיל.";
                messageType = 'warning';
            } else if (!isConnectedToStart) {
                 message = "המסדרון שבנית לא מחובר לשמורת המוצא (R עליונה). נקה ובנה מסלול שמתחיל ליד השמורה.";
                 messageType = 'error'; // More severe error
            }
             else if (reachesEnd) {
                message = `מצוין! המסדרון שלך מחבר את שמורות הטבע!<br>`;
                message += `עלות כוללת: ${stats.cost}. תקציב נותר: ${currentBudget}.<br>`;
                message += `אפקטיביות כוללת: ${stats.effectiveness}.`;
                // Add a simple effectiveness score judgement (optional)
                if (stats.effectiveness >= 100 && stats.cost <= initialBudget) { // Arbitrary high target
                     message += "<br>זהו מסדרון יעיל במיוחד!";
                } else if (stats.effectiveness >= 50 && stats.cost <= initialBudget) {
                    message += "<br>מסדרון טוב, עשית עבודה טובה!";
                } else {
                    message += "<br>הצלחת לחבר, אך האפקטיביות נמוכה יחסית. האם יכולת למצוא נתיב טוב יותר בתקציב?";
                }

                 if (currentBudget < 0) { // Should not happen with the current logic, but as a safeguard
                      message += "<br><strong>אבל חרגת מהתקציב!</strong>";
                      messageType = 'error';
                 } else {
                    messageType = 'success';
                 }


            } else { // Corridor built, connected to start, but doesn't reach end
                 message = `המסדרון שבנית עדיין לא מגיע לשמורת היעד (R תחתונה).<br>`;
                 message += `עלות נוכחית: ${stats.cost}. תקציב נותר: ${currentBudget}.<br>`;
                 message += `אפקטיביות נוכחית: ${stats.effectiveness}.<br>`;
                 message += `המשך לבנות לכיוון היעד!`;
                 messageType = 'info';
            }
            showMessage(message, messageType);
        }

        function showMessage(msg, type = 'info') {
            messageBox.innerHTML = msg;
             // Remove previous classes
             messageBox.classList.remove('success', 'warning', 'error', 'info');
             // Add new class based on type
             messageBox.classList.add(type);
             messageBox.style.opacity = 0; // Start fade-in
             setTimeout(() => {
                 messageBox.style.opacity = 1;
             }, 50); // Small delay for transition to work
        }


        // Event Listeners
        clearCorridorBtn.addEventListener('click', clearCorridor);
        evaluateCorridorBtn.addEventListener('click', evaluateCorridor);
        toggleExplanationBtn.addEventListener('click', () => {
            const isHidden = explanationContent.style.display === 'none';
            explanationContent.style.display = isHidden ? 'block' : 'none';
            toggleExplanationBtn.textContent = isHidden ? 'הסתר הסבר' : 'הצג/הסתר הסבר';
            // Optional: Smooth scroll to explanation if shown
            if (isHidden) {
                 explanationContent.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        });

        // Initial render
        renderMap();
        showMessage(`ברוכים הבאים למשימת בניית מסדרון אקולוגי! התחל בלחיצה על תא נוף כלשהו ליד שמורת הטבע העליונה (R בפינה השמאלית העליונה).`, 'info');
    });
</script>
```