---
title: "חשיפת העבר: לנהל חפירת דינוזאורים"
english_slug: unearthing-the-past-manage-a-dinosaur-excavation
category: "פלאונטולוגיה"
tags: [דינוזאורים, פלאונטולוגיה, חפירות, מדע, ניהול]
---
# חשיפת העבר: לנהל חפירת דינוזאורים

מה קורה כשחופרים באדמה ופתאום מגלים רמז לעצם ענקית מהעבר? הדרך לחשיפת שלד דינוזאור עוצר נשימה היא מסע מאתגר, ארוך ויקר. האם יש לכם את הכישורים לנהל צוות, משאבים ולשרוד את אתגרי השטח כדי לחשוף את הסודות הקבורים עמוק באדמה? בואו נצא למסע אלפי שנים אחורה!

<div id="excavation-app">
    <div class="controls panel">
        <h2>מרכז הבקרה</h2>
        <div id="resources" class="resources-display">
            <p><i class="fas fa-money-bill-wave"></i> תקציב: <span id="budget"></span>₪</p>
            <p><i class="fas fa-clock"></i> ימים נותרו: <span id="time"></span></p>
            <p><i class="fas fa-users"></i> עובדים זמינים: <span id="available-workers"></span></p>
            <p><i class="fas fa-bone"></i> חלקי שלד נמצאו: <span id="found-bones"></span> / <span id="total-bones">?</span></p>
        </div>
        <div id="tools" class="tool-selection">
            <h3>בחירת כלי:</h3>
            <button class="tool-button" data-tool="brush"><i class="fas fa-brush"></i> מברשת <span class="tooltip">(זהיר, איטי, זול)</span></button>
            <button class="tool-button" data-tool="chisel"><i class="fas fa-hammer"></i> איזמל <span class="tooltip">(מהיר יותר, יקר יותר)</span></button>
            <button class="tool-button" data-tool="dynamite"><i class="fas fa-bomb"></i> דינמיט <span class="tooltip">(מהיר מאוד, יקר מאוד, מסוכן!)</span></button>
            <p>כלי נבחר: <span id="selected-tool">לא נבחר</span></p>
        </div>
        <div id="actions" class="action-panel">
             <h3>פעולות באתר:</h3>
             <div class="input-group">
                 <label for="workers-to-assign">הקצה עובדים לתא הנבחר:</label>
                 <input type="number" id="workers-to-assign" value="1" min="0">
                 <button id="assign-workers-button" disabled><i class="fas fa-user-plus"></i> הקצה</button>
             </div>
             <button id="start-excavation-button" disabled><i class="fas fa-shovel"></i> התחל חפירה</button>
        </div>
         <div id="messages" class="message-log">
             <h3>יומן אירועים:</h3>
             <div id="status-messages">מחכים להוראות...</div>
         </div>
    </div>

    <div id="excavation-site" class="panel">
        <h2>שטח החפירות <span id="selected-cell-coords" style="font-size: 0.8em; font-weight: normal; opacity: 0.7;"></span></h2>
        <div id="grid">
            <!-- Grid cells will be generated by JavaScript -->
        </div>
         <div id="cell-details" class="cell-details" style="display: none;">
             <h4>פרטי התא הנבחר:</h4>
             <p>תוכן משוער: <span id="detail-content"></span></p>
             <p>התקדמות: <span id="detail-progress"></span>%</p>
              <div class="progress-bar-container"><div id="detail-progress-bar" class="progress-bar"></div></div>
             <p>עובדים בתא: <span id="detail-workers"></span></p>
         </div>
    </div>

    <div id="results" class="panel">
        <h2>ממצאי החפירה</h2>
        <div id="found-items" class="found-items-list">
            <p>עצמות שנמצאו יופיעו כאן...</p>
        </div>
         <div id="game-status" class="game-status" style="display: none;">
             <h3>סטטוס המשחק</h3>
             <p id="final-message"></p>
             <button id="restart-button"><i class="fas fa-redo"></i> התחל חפירה חדשה</button>
         </div>
    </div>
</div>

<style>
    /* Import Google Fonts and Font Awesome */
    @import url('https://fonts.googleapis.com/css2?family=Heebo:wght@400;700&display=swap');
    @import url('https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css');

    #excavation-app {
        font-family: 'Heebo', sans-serif;
        direction: rtl;
        display: grid;
        grid-template-columns: 1fr 2fr 1fr;
        gap: 30px;
        padding: 30px;
        background: linear-gradient(to bottom right, #f8f9fa, #e9ecef);
        color: #343a40;
        min-height: 80vh;
    }

    .panel {
        background-color: #ffffff;
        padding: 25px;
        border-radius: 12px;
        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
        border: 1px solid #dee2e6;
    }

    .panel h2 {
        text-align: center;
        color: #007bff;
        margin-top: 0;
        margin-bottom: 20px;
        font-weight: 700;
    }

    .resources-display p, .tool-selection h3, .action-panel h3, .message-log h3, .cell-details h4 {
        margin-bottom: 12px;
        color: #495057;
        font-weight: 700;
        display: flex;
        align-items: center;
    }
     .resources-display p i, .tool-selection h3 i, .action-panel h3 i, .message-log h3 i {
         margin-left: 8px;
         color: #007bff;
     }

    .tool-button, #assign-workers-button, #start-excavation-button, #restart-button {
        padding: 10px 15px;
        margin: 5px 0;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        background-color: #007bff;
        color: white;
        font-size: 1em;
        transition: background-color 0.3s ease, transform 0.1s ease;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        position: relative; /* For tooltip */
    }
     .tool-button i, #assign-workers-button i, #start-excavation-button i, #restart-button i {
         margin-left: 8px;
     }

     .tool-button .tooltip {
         visibility: hidden;
         width: 120px;
         background-color: #555;
         color: #fff;
         text-align: center;
         border-radius: 6px;
         padding: 5px 0;
         position: absolute;
         z-index: 1;
         bottom: 125%; /* Position above the button */
         right: 50%;
         margin-right: -60px; /* Center the tooltip */
         opacity: 0;
         transition: opacity 0.3s;
         font-size: 0.8em;
     }
     .tool-button:hover .tooltip {
         visibility: visible;
         opacity: 1;
     }


     .tool-button.selected {
         background-color: #0056b3;
         box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.2);
     }

    .tool-button:hover:not(:disabled), #assign-workers-button:hover:not(:disabled), #start-excavation-button:hover:not(:disabled), #restart-button:hover:not(:disabled) {
        background-color: #0056b3;
        transform: translateY(-2px);
    }

     button:disabled {
         background-color: #cccccc;
         cursor: not-allowed;
         transform: none;
         box-shadow: none;
     }

     .input-group {
         margin-bottom: 15px;
         display: flex;
         align-items: center;
         gap: 10px;
     }
     .input-group label {
         flex-shrink: 0;
     }
     .input-group input[type="number"] {
         width: 60px;
         padding: 8px;
         border: 1px solid #ced4da;
         border-radius: 4px;
     }


    #grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(70px, 1fr)); /* Responsive grid */
        gap: 8px;
        margin-top: 20px;
        justify-content: center;
        perspective: 1000px; /* For 3D transforms */
    }

    .grid-cell {
        width: 100%; /* Fill grid column */
        padding-bottom: 100%; /* Makes height equal to width for square */
        position: relative; /* For absolute positioning of content */
        background-color: #8b4513; /* Earth color */
        border: 2px solid #5a2d0c;
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: background-color 0.3s ease, border-color 0.3s ease, transform 0.3s ease;
        user-select: none;
        font-size: 0.9em;
        font-weight: bold;
        color: rgba(255, 255, 255, 0.8);
        overflow: hidden; /* Hide overflowing progress bar */
        box-sizing: border-box; /* Include padding/border in element's total width/height */
        transform-style: preserve-3d; /* For flip animation */
        transform: rotateY(0deg);
    }

     /* Inner content for the flip effect */
     .grid-cell-inner {
         position: absolute;
         width: 100%;
         height: 100%;
         backface-visibility: hidden; /* Hide backside during flip */
         display: flex;
         flex-direction: column;
         align-items: center;
         justify-content: center;
         padding: 5px; /* Inner padding */
         box-sizing: border-box;
     }
     .grid-cell .front { transform: rotateY(0deg); }
     .grid-cell .back { transform: rotateY(180deg); }

    .grid-cell:hover:not(.revealed):not(.selected) {
         background-color: #a0522d;
         border-color: #6b3a1a;
    }

     .grid-cell.selected {
         border: 3px dashed #ffc107;
         box-shadow: 0 0 10px rgba(255, 193, 7, 0.5);
         background-color: #a0522d; /* Darker when selected */
     }

    .grid-cell.revealed {
        background-color: #d2b48c; /* Lighter color when excavated */
        cursor: default;
        color: #333;
        transform: rotateY(180deg); /* Flip animation */
    }

    .grid-cell.revealed .front { display: none; } /* Hide front when flipped */
    .grid-cell.revealed .back { display: flex; } /* Show back when flipped */


    .grid-cell.revealed.bone {
        background-color: #ffe4c4; /* Bone color */
        color: #8b4513;
        font-size: 1em;
    }
     .grid-cell.revealed.rock {
         background-color: #c4c4c4; /* Rock color */
         color: #495057;
     }
     .grid-cell.revealed.obstacle {
        background-color: #ff9185; /* Obstacle color */
         color: #d9534f;
     }
     .grid-cell.revealed.empty {
         background-color: #d2b48c;
         color: #5a2d0c;
     }

    /* Progress Bar */
     .progress-bar-container {
         position: absolute;
         bottom: 0;
         left: 0;
         width: 100%;
         height: 8px;
         background-color: rgba(0, 0, 0, 0.2);
         border-radius: 0 0 8px 8px;
         overflow: hidden;
     }
     .progress-bar {
         height: 100%;
         width: 0%;
         background-color: #28a745;
         transition: width 0.5s ease;
     }
      .grid-cell.selected .progress-bar-container {
          display: block; /* Show progress bar when selected or excavating */
      }
      .grid-cell:not(.selected):not(.revealed) .progress-bar-container {
          display: none; /* Hide when not selected/revealed */
      }
      .grid-cell.revealed .progress-bar-container {
          display: none; /* Hide when revealed */
      }


    /* Worker icon on cell */
     .worker-icon {
         position: absolute;
         top: 5px;
         right: 5px;
         color: #007bff;
         font-size: 1.2em;
         text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
     }
     .worker-count {
         position: absolute;
         bottom: 5px;
         left: 5px;
         background-color: rgba(0,0,0,0.5);
         color: white;
         border-radius: 4px;
         padding: 2px 5px;
         font-size: 0.8em;
     }


    .message-log {
        min-height: 100px;
        border: 1px solid #ced4da;
        padding: 15px;
        border-radius: 8px;
        background-color: #e9ecef;
        overflow-y: auto; /* Scroll if messages overflow */
        max-height: 150px; /* Limit height */
    }
     #status-messages {
         margin-top: 10px;
         font-size: 0.9em;
         color: #343a40;
     }

    .found-items-list {
        min-height: 100px;
        border: 1px solid #ced4da;
        padding: 15px;
        border-radius: 8px;
        background-color: #e9ecef;
        overflow-y: auto;
         max-height: 150px;
    }
     .found-items-list p {
         margin-bottom: 5px;
         padding-bottom: 5px;
         border-bottom: 1px dashed #adb5bd;
         font-size: 0.9em;
         color: #495057;
     }
     .found-items-list p:last-child {
         border-bottom: none;
     }


     .cell-details {
         margin-top: 20px;
         padding: 15px;
         background-color: #f8f9fa;
         border: 1px solid #dee2e6;
         border-radius: 8px;
     }
     .cell-details p {
         margin-bottom: 8px;
         font-size: 0.9em;
     }
     .cell-details h4 {
         margin-top: 0;
         margin-bottom: 10px;
         color: #007bff;
     }
      .cell-details .progress-bar-container {
          position: static; /* Override absolute positioning for this display */
          width: 100%;
          height: 10px;
          background-color: #e9ecef;
          border-radius: 5px;
          margin-top: 5px;
      }
       .cell-details .progress-bar {
           height: 100%;
           background-color: #28a745;
           border-radius: 5px;
       }


     .game-status {
         margin-top: 20px;
         padding-top: 20px;
         border-top: 2px dashed #ced4da;
         text-align: center;
         font-size: 1.1em;
         font-weight: bold;
     }
      .game-status h3 {
          color: #28a745; /* Success color */
          margin-bottom: 15px;
          font-size: 1.5em;
      }
      .game-status p {
          margin-bottom: 20px;
          color: #343a40;
      }
      #restart-button {
          background-color: #6c757d;
      }
       #restart-button:hover {
           background-color: #5a6268;
       }

    /* Responsive adjustments */
    @media (max-width: 992px) {
        #excavation-app {
            grid-template-columns: 1fr;
        }
        .controls { order: 2; }
        #excavation-site { order: 1; }
        #results { order: 3; }
        #grid {
            grid-template-columns: repeat(auto-fit, minmax(50px, 1fr)); /* Smaller cells on small screens */
            gap: 5px;
        }
    }

</style>

<button id="toggle-explanation" class="toggle-button"><i class="fas fa-book-open"></i> הצג/הסתר הסבר על פלאונטולוגיה</button>

<div id="explanation" class="explanation-panel" style="display: none;">
    <h2><i class="fas fa-graduation-cap"></i> הסבר על פלאונטולוגיה וחפירות דינוזאורים</h2>

    <h3>מהי פלאונטולוגיה ולמה חופרים?</h3>
    פלאונטולוגיה היא מדע העוסק בחקר החיים הקדומים, בעיקר באמצעות מאובנים – השרידים המדהימים של יצורים שחיו לפני מיליוני שנים. פלאונטולוגים הם בלשים של העבר הרחוק, החוקרים אורגניזמים שחיו לפני מיליוני ומיליארדי שנים כדי לפענח את סודות האבולוציה, להבין כיצד האקלים השתנה גלובלית, ולחשוף את ההיסטוריה הגאולוגית הסוערת של כדור הארץ. חפירות פלאונטולוגיות הן המפתח למציאת אוצרות העבר הללו.

    <h3>כיצד נוצרים מאובנים (תהליך ההתאבנות)?</h3>
    תהליך ההתאבנות הוא נדיר ומרתק! לרוב, הוא מתחיל כשייצור מת ושרידיו נקברים במהירות תחת שכבות הגנה של בוץ, חול או אפר געשי. קבורה מהירה זו מונעת ריקבון או טריפה. לאורך עידנים גאולוגיים, מינרלים המומסים במים המחלחלים דרך המשקעים מחליפים אט אט את החומר האורגני בעצמות או בקונכיות, או ממלאים חללים שנותרו. כך, העצם המקורית "מתאבנת" והופכת לסלע, אך שומרת על צורתה המקורית. לעיתים נוצרת רק "תבנית" – הדפס של הייצור בסלע.

    <h3>איתור אתרי חפירה: איך יודעים איפה לחפש אוצרות?</h3>
    פלאונטולוגים הם סיירים מיומנים! הם מחפשים מאובנים בשכבות סלע מהתקופות הגיאולוגיות שבהן חיו היצורים המעניינים אותם (לדוגמה, תקופות הטריאס, היורה והקרטיקון עבור דינוזאורים). הם מסתמכים על מפות גאולוגיות מפורטות, צילומי אוויר, ולעיתים קרובות על דיווחים מרגשים מאנשי שטח – גיאולוגים, מטיילים או אפילו מקומיים שנתקלו בעצמות בולטות מהקרקע. אתרים מבטיחים נמצאים לרוב באזורים חשופים לסחיפה (כמו מדבריות, קניונים או ערוצי נחלים), שם שכבות סלע עתיקות נחשפות לפני השטח.

    <h3>שלבי החפירה הפלאונטולוגית: ממציאה בשטח עד מעבדה מודרנית</h3>
    1.  **סקר וגילוי ראשוני:** סיור בשטח, זיהוי מאובנים בולטים, ותיעוד ראשוני של האתר.
    2.  **הכנת האתר:** פינוי זהיר של שכבות אדמה וסלע עליונות כדי להגיע לשכבה הפורייה.
    3.  **חפירה עדינה ומדויקת:** חשיפת המאובנים עצמם באמצעות כלים עדינים ביותר – מברשות, איזמלים קטנים, כלי עבודה דנטליים ואפילו קיסמים. כל תנועה חייבת להיות מחושבת.
    4.  **תיעוד קפדני:** צילום מכל זווית, מיפוי מדויק של מיקום כל עצם, ורישום מפורט של כל פרט קטן. כל פיסת מידע חשובה!
    5.  **ייצוב ושימור בשטח:** עצמות מאובנות נוטות להיות שבירות. בשטח מייצבים אותן באמצעות חומרים מקשים מיוחדים (סוג של דבקים).
    6.  **עטיפה והגנה (ה"ג'קט"):** עטיפת המאובן, לעיתים בגוש הסלע שמסביבו, בשכבת הגנה קשיחה כמו זו שמשמשת לגבס, או תערובת של יוטה וחומר פלסטי. זהו "ג'קט" המגן על המאובן העדין בדרכו הארוכה.
    7.  **הוצאה והובלה:** ניסור או שבירה זהירה של הסלע מסביב ל"ג'קט" והובלתו, לעיתים באמצעות ציוד כבד או אפילו מסוקים, למעבדה.

    <h3>כלים וטכניקות בחפירה</h3>
    הארסנל הפלאונטולוגי מגוון! הוא כולל כלים מיקרוסקופיים לעבודה צמודה על העצם, כלי יד כמו איזמלים ופטישים, מקדחות חשמליות מיוחדות, ולעיתים – אם שכבת הסלע מעל עבה במיוחד – נעשה שימוש מבוקר מאוד בדינמיט! כן, גם חומרי נפץ נכנסים לתמונה (תחת פיקוח מחמיר כמובן). חומרים לחיזוק ושימור (דבקים, לכות) וציוד טכנולוגי (מצלמות ברזולוציה גבוהה, GPS, סורקים תלת-ממדיים) חיוניים גם הם.

    <h3>אתגרים נפוצים בחפירות (גאולוגיה עקשנית, מזג אוויר הפכפך, תקציב מוגבל)</h3>
    החפירות מתקיימות לרוב במקומות נידחים ובתנאים לא פשוטים: סלע קשה שיכול לשבור כלים, סלע מתפורר שדורש זהירות יתרה, חום לוהט או קור מקפיא, סופות חול וגשמים עזים. האתגרים הלוגיסטיים עצומים – להביא ציוד, מים ואספקה לאתר מרוחק. בנוסף, פרויקטים פלאונטולוגיים מסתמכים לרוב על מענקי מחקר ותרומות, והתקציב דורש תכנון מדוקדק של כל הוצאה – כוח אדם, ציוד וזמן יקר.

    <h3>מה קורה למאובנים לאחר החפירה (ניקוי, שימור, הרכבה, מחקר פורץ דרך)</h3>
    המסע לא נגמר בשטח! במעבדה, המאובנים מוצאים מה"ג'קטים", מנוקים בסבלנות ובדייקנות מהסלע שמסביב באמצעות כלים עדינים, חומצות או חומרים ממיסים. הם עוברים תהליך שימור נוסף לחיזוקם. אם נמצאו מספיק חלקים, אפשר להתחיל במלאכת ההרכבה המורכבת של השלד – כמו פאזל ענק מהעבר. השלב המכריע הוא המחקר המדעי: פלאונטולוגים חוקרים את המאובנים באמצעות השוואה ליצורים אחרים, סריקות CT, בדיקות כימיות, וטכניקות מודרניות נוספות, כדי ללמוד על הביולוגיה של היצור הקדום, אורח חייו, הסביבה שבה חי, ומקומו על עץ החיים העצום.

    <h3>חשיבות גילוי המאובנים להבנת החיים על פני כדור הארץ</h3>
    מאובנים הם כמו מנהרת זמן! הם הראיה הישירה היחידה שיש לנו לחיים שהתקיימו על פני כדור הארץ לפני שהופיעו בני האדם. הם מספקים הוכחות חותכות לאבולוציה, מאפשרים לנו לדמיין מחדש סביבות קדומות ואקלים שחלפו מן העולם, וללמוד על אירועים דרמטיים כמו הכחדות המוניות שעיצבו את עולם החי והצומח שאנו מכירים כיום. כל מאובן חדש שנמצא יכול לשנות את ההבנה שלנו על ההיסטוריה הארוכה והמרתקת של החיים על כדור הארץ.

    <p style="text-align: center; margin-top: 20px; font-style: italic;">כעת, חזרה לשטח! עתיד המחקר תלוי בכם...</p>
</div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const gridElement = document.getElementById('grid');
        const statusMessages = document.getElementById('status-messages');
        const foundItems = document.getElementById('found-items');
        const budgetElement = document.getElementById('budget');
        const timeElement = document.getElementById('time');
        const availableWorkersElement = document.getElementById('available-workers');
        const foundBonesElement = document.getElementById('found-bones');
        const totalBonesElement = document.getElementById('total-bones');
        const toolButtons = document.querySelectorAll('.tool-button');
        const selectedToolElement = document.getElementById('selected-tool');
        const workersToAssignInput = document.getElementById('workers-to-assign');
        const assignWorkersButton = document.getElementById('assign-workers-button');
        const startExcavationButton = document.getElementById('start-excavation-button');
        const gameStatusDiv = document.getElementById('game-status');
        const finalMessageElement = document.getElementById('final-message');
        const restartButton = document.getElementById('restart-button');
        const explanationDiv = document.getElementById('explanation');
        const toggleExplanationButton = document.getElementById('toggle-explanation');
        const selectedCellCoordsElement = document.getElementById('selected-cell-coords');
        const cellDetailsDiv = document.getElementById('cell-details');
        const detailContentElement = document.getElementById('detail-content');
        const detailProgressElement = document.getElementById('detail-progress');
        const detailProgressBarElement = document.getElementById('detail-progress-bar');
        const detailWorkersElement = document.getElementById('detail-workers');


        let budget = 15000; // Increased budget
        let time = 40; // Increased time
        let totalWorkers = 15; // Increased workers
        let availableWorkers = totalWorkers;
        let grid;
        const gridSize = 6; // 6x6 grid
        let selectedCell = null;
        let selectedTool = null;
        let bonesFound = 0;
        let totalBones = 0;

        // Define costs, times, and effectiveness per tool
        // Costs are per worker-day per cell
        // Effectiveness is base progress percentage per worker-day per base difficulty unit
        const toolStats = {
            brush: { cost: 40, effectiveness: 8, risk: 0.05, boneMultiplier: 1.5 }, // Safe, slow, low cost, good for bone
            chisel: { cost: 80, effectiveness: 12, risk: 0.1, boneMultiplier: 1.0 }, // Medium, medium, medium risk
            dynamite: { cost: 250, effectiveness: 30, risk: 0.4, boneMultiplier: 0.5 } // Fast, high cost, high risk, bad for bone
        };

        // Define cell contents and their base excavation difficulty
        const cellContents = {
            EMPTY: { name: 'אדמה רגילה', difficulty: 10, color: '#d2b48c' },
            BONE: { name: 'עצם מאובנת!', difficulty: 15, color: '#ffe4c4' }, // Bones require more care
            ROCK: { name: 'סלע קשה', difficulty: 25, color: '#c4c4c4' }, // Rocks are hard
            OBSTACLE: { name: 'מכשול בלתי צפוי', difficulty: 20, color: '#ff9185' } // Obstacles take extra effort
        };

        // Define cell states
        const cellStates = {
            COVERED: 'covered',
            SELECTED: 'selected',
            REVEALED: 'revealed'
        };

        function createGrid() {
            gridElement.innerHTML = ''; // Clear previous grid
            grid = [];
            bonesFound = 0; // Reset found bones for new game
            totalBones = 0; // Reset total bones

            // Generate contents with more variety and guarantee at least some bones
             const contents = [];
             const minBones = 5; // Ensure at least 5 bones
             const minRocks = 5;
             const minObstacles = 3;

             for(let i = 0; i < minBones; i++) contents.push(cellContents.BONE.name);
             for(let i = 0; i < minRocks; i++) contents.push(cellContents.ROCK.name);
             for(let i = 0; i < minObstacles; i++) contents.push(cellContents.OBSTACLE.name);

             while (contents.length < gridSize * gridSize) {
                 contents.push(cellContents.EMPTY.name);
             }

            // Shuffle contents
            for (let i = contents.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [contents[i], contents[j]] = [contents[j], contents[i]]; // Swap
            }

            let contentIndex = 0;
            for (let i = 0; i < gridSize; i++) {
                grid[i] = [];
                for (let j = 0; j < gridSize; j++) {
                    const cellContentName = contents[contentIndex++];
                     const cellContent = Object.values(cellContents).find(c => c.name === cellContentName); // Find full content object
                    if(cellContent === cellContents.BONE) {
                        totalBones++;
                    }
                    const cell = {
                        row: i,
                        col: j,
                        content: cellContent, // Store full object
                        state: cellStates.COVERED,
                        workers: 0,
                        progress: 0, // Excavation progress (0 to 100)
                         initialDifficulty: cellContent.difficulty // Store initial difficulty
                    };
                    grid[i][j] = cell;

                    const cellElement = document.createElement('div');
                    cellElement.classList.add('grid-cell');
                    cellElement.dataset.row = i;
                    cellElement.dataset.col = j;

                     // Add inner divs for flip effect
                     const innerFront = document.createElement('div');
                     innerFront.classList.add('grid-cell-inner', 'front');
                      innerFront.innerHTML = '<i class="fas fa-gem"></i>'; // Placeholder icon
                     cellElement.appendChild(innerFront);

                     const innerBack = document.createElement('div');
                     innerBack.classList.add('grid-cell-inner', 'back');
                     innerBack.textContent = ''; // Content will be added later
                     cellElement.appendChild(innerBack);

                     const progressBarContainer = document.createElement('div');
                     progressBarContainer.classList.add('progress-bar-container');
                     const progressBar = document.createElement('div');
                     progressBar.classList.add('progress-bar');
                     progressBarContainer.appendChild(progressBar);
                     cellElement.appendChild(progressBarContainer);


                    cellElement.addEventListener('click', handleCellClick);
                    gridElement.appendChild(cellElement);
                }
            }
             totalBonesElement.textContent = totalBones;

             // Adjust grid columns based on size
             gridElement.style.gridTemplateColumns = `repeat(${gridSize}, 1fr)`;
        }

        function updateUI() {
            budgetElement.textContent = budget.toFixed(0);
            timeElement.textContent = time;
            availableWorkersElement.textContent = availableWorkers;
            foundBonesElement.textContent = bonesFound;
            selectedToolElement.textContent = selectedTool ? `✨ ${selectedTool}` : 'לא נבחר';

            // Update grid cell appearance
            document.querySelectorAll('.grid-cell').forEach(cellElement => {
                const row = parseInt(cellElement.dataset.row);
                const col = parseInt(cellElement.dataset.col);
                const cell = grid[row][col];
                const innerBack = cellElement.querySelector('.back');
                 const progressBar = cellElement.querySelector('.progress-bar');
                 const progressBarContainer = cellElement.querySelector('.progress-bar-container');


                cellElement.className = 'grid-cell'; // Reset classes
                cellElement.classList.add(cell.state); // Add state class

                 // Update progress bar
                 progressBar.style.width = `${cell.progress}%`;
                 if (cell.state === cellStates.SELECTED || cell.workers > 0) {
                     progressBarContainer.style.display = 'block';
                 } else {
                      progressBarContainer.style.display = 'none';
                 }


                if (cell.state === cellStates.REVEALED) {
                     cellElement.classList.add(cell.content === cellContents.BONE ? 'bone' : cell.content === cellContents.ROCK ? 'rock' : cell.content === cellContents.OBSTACLE ? 'obstacle' : 'empty'); // Add content class if revealed

                     // Update text content on the 'back' of the flipped cell
                     innerBack.innerHTML = ''; // Clear previous
                     if (cell.content === cellContents.BONE) {
                          innerBack.innerHTML = '<i class="fas fa-bone"></i> עצם!';
                     } else if (cell.content === cellContents.ROCK) {
                          innerBack.innerHTML = '<i class="fas fa-mountain"></i> סלע!';
                     } else if (cell.content === cellContents.OBSTACLE) {
                          innerBack.innerHTML = '<i class="fas fa-times-circle"></i> מכשול!';
                     } else {
                          innerBack.innerHTML = '<i class="fas fa-gem"></i> ריק';
                     }

                } else {
                     // Content/icons for covered/selected state
                     const innerFront = cellElement.querySelector('.front');
                     innerFront.innerHTML = '<i class="fas fa-gem"></i>'; // Default icon

                    // Show worker count and icon on covered/selected cells
                    let workerInfo = '';
                    if(cell.workers > 0) {
                         innerFront.innerHTML += `<span class="worker-icon"><i class="fas fa-shovel"></i></span><span class="worker-count">${cell.workers}</span>`;
                    }
                }
            });

            // Update tool button selection state
            toolButtons.forEach(button => {
                if (button.dataset.tool === selectedTool) {
                    button.classList.add('selected');
                } else {
                    button.classList.remove('selected');
                }
            });

            // Update button disabled states
             assignWorkersButton.disabled = selectedCell === null || availableWorkers === 0 || selectedCell.state === cellStates.REVEALED;
             startExcavationButton.disabled = selectedCell === null || selectedCell.workers === 0 || selectedTool === null || selectedCell.state === cellStates.REVEALED;
             workersToAssignInput.disabled = selectedCell === null || selectedCell.state === cellStates.REVEALED;

             // Update cell details panel
             if (selectedCell && selectedCell.state !== cellStates.REVEALED) {
                 cellDetailsDiv.style.display = 'block';
                 selectedCellCoordsElement.textContent = `[${selectedCell.row + 1}, ${selectedCell.col + 1}]`;
                 detailContentElement.textContent = selectedCell.content.name;
                 detailProgressElement.textContent = selectedCell.progress.toFixed(1);
                 detailProgressBarElement.style.width = `${selectedCell.progress}%`;
                 detailWorkersElement.textContent = selectedCell.workers;
             } else {
                 cellDetailsDiv.style.display = 'none';
                 selectedCellCoordsElement.textContent = '';
             }

            // Check for game over conditions
            if (time <= 0 || budget <= 0 || bonesFound === totalBones && totalBones > 0) {
                 endGame();
             }
        }

        function handleCellClick(event) {
            const cellElement = event.currentTarget; // Use currentTarget for listener on the div
            const row = parseInt(cellElement.dataset.row);
            const col = parseInt(cellElement.dataset.col);
            const clickedCell = grid[row][col];

            if (clickedCell.state === cellStates.REVEALED) {
                statusMessages.textContent = `תא [${row + 1}, ${col + 1}] כבר נחפר לחלוטין.`;
                return; // Cannot select revealed cells
            }

            // Deselect previous cell if any
            if (selectedCell && selectedCell !== clickedCell) {
                selectedCell.state = selectedCell.workers > 0 ? cellStates.COVERED : cellStates.COVERED; // Keep state as covered or excavating visual
                 // Remove selected visual from previous cell element
                 document.querySelector(`.grid-cell[data-row='${selectedCell.row}'][data-col='${selectedCell.col}']`).classList.remove('selected');
            }

             // Select the clicked cell
            if (selectedCell !== clickedCell) {
                 selectedCell = clickedCell;
                 selectedCell.state = cellStates.SELECTED;
                  statusMessages.textContent = `תא [${row + 1}, ${col + 1}] נבחר. התקדמות: ${selectedCell.progress.toFixed(1)}%.`;
            } else {
                 // Clicking again deselects
                 selectedCell.state = selectedCell.workers > 0 ? cellStates.COVERED : cellStates.COVERED; // Keep state as covered or excavating visual
                 selectedCell = null;
                  statusMessages.textContent = 'הבחירה בוטלה.';
            }


            // Update UI to show selected cell
            updateUI();
        }

        function handleToolClick(event) {
            selectedTool = event.currentTarget.dataset.tool; // Use currentTarget
             statusMessages.textContent = `כלי נבחר: ${selectedTool}`;
             // Update start button state based on potential workers
             startExcavationButton.disabled = selectedCell === null || selectedCell.workers === 0 || selectedTool === null || selectedCell.state === cellStates.REVEALED;

            updateUI();
        }

        function handleAssignWorkers() {
            if (!selectedCell) {
                 statusMessages.textContent = 'אנא בחר תא לחפירה תחילה.';
                 return;
             }
             if (selectedCell.state === cellStates.REVEALED) {
                  statusMessages.textContent = 'התא הזה כבר נחפר.';
                  return;
             }

            const workers = parseInt(workersToAssignInput.value);
            if (isNaN(workers) || workers <= 0) {
                 statusMessages.textContent = 'מספר עובדים לא חוקי.';
                 return;
             }

            if (workers > availableWorkers) {
                statusMessages.textContent = `אין מספיק עובדים זמינים. נותרו רק ${availableWorkers}.`;
                return;
            }

            // Assign workers to the selected cell
            selectedCell.workers += workers;
            availableWorkers -= workers;
             statusMessages.textContent = `${workers} עובדים הוקצו לתא [${selectedCell.row + 1}, ${selectedCell.col + 1}]. כעת ${selectedCell.workers} עובדים עובדים כאן.`;

            // Reset input
            workersToAssignInput.value = 1;
            updateUI();
        }

         function handleStartExcavation() {
             if (!selectedCell) {
                  statusMessages.textContent = 'אנא בחר תא לחפירה תחילה.';
                  return;
              }
             if (!selectedTool) {
                  statusMessages.textContent = 'אנא בחר כלי לחפירה תחילה.';
                  return;
             }
             if (selectedCell.workers === 0) {
                  statusMessages.textContent = 'אין עובדים שהוקצו לתא הנבחר.';
                  return;
                  }
             if (selectedCell.state === cellStates.REVEALED) {
                 statusMessages.textContent = 'התא הזה כבר נחפר.';
                 return;
             }


             // Simulate excavation turn
             const cell = selectedCell;
             const workers = cell.workers;
             const tool = selectedTool;
             const toolStat = toolStats[tool];

             // Calculate cost for this turn
             const turnCost = workers * toolStat.cost;

             // Check if enough budget
             if (budget < turnCost) {
                 statusMessages.textContent = `אין מספיק תקציב (${budget}₪) להפעלת ${workers} עובדים עם ${tool} (עלות: ${turnCost}₪ ליום).`;
                 return;
             }
             // Check if enough time
              if (time < 1) {
                   statusMessages.textContent = 'נגמר הזמן לחפירה!';
                   return;
              }


             // Calculate progress gained in this turn
             // Progress = workers * tool_effectiveness * tool_bone_multiplier (if bone) / cell_difficulty
             let baseProgress = workers * toolStat.effectiveness;
             if (cell.content === cellContents.BONE) {
                 baseProgress *= toolStat.boneMultiplier; // Modifier for bone
             }
              // Obstacles and rocks are just harder, handled by initialDifficulty

             const progressGained = (baseProgress / cell.initialDifficulty); // Simple calculation: higher is faster


             // Deduct cost and time
             budget -= turnCost;
             time -= 1; // Each turn takes 1 day

             // Add progress
             cell.progress += progressGained;
             if (cell.progress > 100) cell.progress = 100; // Cap at 100%


             // --- Simulate Events and Risks ---
             let message = `צוות של ${workers} עובדים חופר בתא [${cell.row + 1}, ${cell.col + 1}] באמצעות ${tool}. `;

             // Risk of incidents based on tool risk stat
             if (Math.random() < toolStat.risk) {
                  const incidentType = Math.random();
                  if (tool === 'dynamite' && incidentType < 0.6) { // High chance with dynamite
                      const lostWorkers = Math.floor(Math.random() * (workers > 1 ? Math.min(workers - 1, 3) : 1)) + 1; // Lose 1-3 workers (or 1 if only 1 worker)
                      availableWorkers -= lostWorkers;
                      cell.workers -= lostWorkers; // Workers removed from cell
                       if (cell.workers < 0) cell.workers = 0; // Should not happen with min, but safety
                       if (availableWorkers < 0) availableWorkers = 0;
                      message += `!!! אירוע מסוכן עם דינמיט! ${lostWorkers} עובדים נפגעו ואינם זמינים יותר. (עלות טיפול: ${lostWorkers * 500}₪)`;
                      budget -= lostWorkers * 500;
                  } else if (toolStat.risk > 0.1 && incidentType < 0.8) { // Medium to high risk tools - equipment breakdown
                       const penaltyCost = Math.floor(budget * 0.05); // 5% budget penalty
                       message += `! תקלה בציוד! נדרשים תיקונים. (עלות: ${penaltyCost}₪)`;
                       budget -= penaltyCost;
                  } else { // Lower risk tools or less severe incidents
                      const timePenalty = Math.ceil(Math.random() * 2); // Lose 1-2 days
                      time -= timePenalty;
                      message += `! תנאי שטח קשים האטו את העבודה. איבדנו ${timePenalty} ימים.`;
                  }
             }

             // Risk of damaging bones if not using brush on Bone cells (only before completion)
             if (cell.content === cellContents.BONE && tool !== 'brush' && cell.progress < 95 && Math.random() < (toolStat.risk + 0.1)) { // Higher chance than normal risk
                  message += " <span style='color: orange; font-weight: bold;'>זהירות! העצם שברירית! נגרם נזק קל.</span> ";
                  // Could add a penalty here like slightly less value to the bone find, or increase future difficulty for this cell slightly.
                  // For now, just a warning message adds flavor.
             }

             // Add a positive event occasionally
             if (Math.random() < 0.05 && message.indexOf('!!!') === -1) { // 5% chance, only if no major incident
                 const bonusBudget = Math.floor(budget * 0.03); // 3% bonus
                 const bonusWorkers = Math.floor(Math.random() * 2); // 0-1 bonus workers
                 message += `! צוות העובדים עבד ביעילות יוצאת דופן! חסכנו ${bonusBudget}₪ ואולי הצטרפו ${bonusWorkers} עובדים חדשים!`;
                  budget += bonusBudget;
                  availableWorkers += bonusWorkers;
                  totalWorkers += bonusWorkers; // Add to total for next reset
             }


             statusMessages.textContent = message;


             // Check if excavation is complete for this cell
             if (cell.progress >= 100) {
                 cell.state = cellStates.REVEALED;
                 availableWorkers += cell.workers; // Workers return
                 cell.workers = 0; // Reset workers for this cell


                 if (cell.content === cellContents.BONE) {
                     bonesFound++;
                     foundItems.innerHTML = `<p><i class="fas fa-check-circle" style="color: green;"></i> מציאה מדהימה! נמצאה עצם בתא [${cell.row + 1}, ${cell.col + 1}]!</p>` + foundItems.innerHTML; // Add to top
                 } else {
                      foundItems.innerHTML = `<p><i class="fas fa-info-circle" style="color: blue;"></i> בתא [${cell.row + 1}, ${cell.col + 1}] נמצא... ${cell.content.name}.</p>` + foundItems.innerHTML; // Add to top
                 }

                 selectedCell = null; // Deselect after completion
                 statusMessages.textContent += " התא נחפר לחלוטין!";
             } else {
                 // Cell still needs more work
                 statusMessages.textContent += ` התקדמות נוכחית: ${cell.progress.toFixed(1)}%.`;
             }

            updateUI();
            checkGameEnd();
         }

         function checkGameEnd() {
              if (time <= 0 || budget <= 0 || (totalBones > 0 && bonesFound === totalBones) ) {
                  endGame();
              }
         }

         function endGame() {
             let finalMessage = "";
              let finalStatus = "";
             if (totalBones > 0 && bonesFound === totalBones) {
                 finalStatus = "הצלחה מדהימה!";
                 finalMessage = `מזל טוב, בלשים! חשפתם את כל ${totalBones} חלקי השלד האבוד! נותרו לכם ${budget.toFixed(0)}₪ ו-${time} ימים. המאמץ השתלם בגדול!`;
                 gameStatusDiv.style.color = '#28a745'; // Green for success
             } else if (time <= 0) {
                 finalStatus = "הזמן אזל!";
                 finalMessage = `הזמן המוקצב לחפירה הסתיים! חשפתם רק ${bonesFound} מתוך ${totalBones || '?'} חלקי השלד. נדרש עוד זמן יקר להשלמת המשימה.`;
                 gameStatusDiv.style.color = '#dc3545'; // Red for failure
             } else if (budget <= 0) {
                 finalStatus = "התקציב הסתיים!";
                 finalMessage = `נגמר הכסף! חשפתם רק ${bonesFound} מתוך ${totalBones || '?'} חלקי השלד. לא נשאר תקציב להמשך העבודה בשטח.`;
                 gameStatusDiv.style.color = '#dc3545'; // Red for failure
             } else {
                 // Should not happen with the current check, but as a fallback
                 finalStatus = "המשחק הסתיים";
                 finalMessage = `המשחק הסתיים. חשפתם ${bonesFound} מתוך ${totalBones || '?'} עצמות.`;
             }

             gameStatusDiv.querySelector('h3').textContent = finalStatus;
             finalMessageElement.textContent = finalMessage;
             gameStatusDiv.style.display = 'block';

             // Disable game controls
             toolButtons.forEach(btn => btn.disabled = true);
             assignWorkersButton.disabled = true;
             startExcavationButton.disabled = true;
             workersToAssignInput.disabled = true;
             document.querySelectorAll('.grid-cell').forEach(cell => cell.removeEventListener('click', handleCellClick)); // Prevent further clicks
             selectedCell = null; // Clear selected cell
             updateUI(); // Update UI one last time to show final state
         }


         function resetGame() {
             budget = 15000;
             time = 40;
             totalWorkers = 15;
             availableWorkers = totalWorkers;
             selectedCell = null;
             selectedTool = null;
             bonesFound = 0;
             totalBones = 0; // Will be recalculated in createGrid

             foundItems.innerHTML = '<p>עצמות שנמצאו יופיעו כאן...</p>'; // Reset found items message
             statusMessages.textContent = 'מתחילים חפירה חדשה! בחרו תא וכלי.';
             gameStatusDiv.style.display = 'none';
             finalMessageElement.textContent = '';
             cellDetailsDiv.style.display = 'none';
             selectedCellCoordsElement.textContent = '';


              // Re-enable controls
             toolButtons.forEach(btn => btn.disabled = false);
             workersToAssignInput.disabled = false;
             selectedToolElement.textContent = 'לא נבחר';

              // Re-add click listeners to grid cells (they were removed in endGame)
             // Need to regenerate the grid first
             createGrid(); // Generate a new grid

              document.querySelectorAll('.grid-cell').forEach(cellElement => {
                   cellElement.addEventListener('click', handleCellClick);
              });

             updateUI(); // Update all UI elements
         }


        // Event Listeners
        toolButtons.forEach(button => button.addEventListener('click', handleToolClick));
        assignWorkersButton.addEventListener('click', handleAssignWorkers);
        startExcavationButton.addEventListener('click', handleStartExcavation);
         restartButton.addEventListener('click', resetGame);

         toggleExplanationButton.addEventListener('click', () => {
             const isHidden = explanationDiv.style.display === 'none';
             explanationDiv.style.display = isHidden ? 'block' : 'none';
             toggleExplanationButton.textContent = isHidden ? '<i class="fas fa-book-open"></i> הסתר הסבר על פלאונטולוגיה' : '<i class="fas fa-book-open"></i> הצג/הסתר הסבר על פלאונטולוגיה';
              toggleExplanationButton.classList.toggle('active', isHidden); /* Optional: Add active class for styling */
         });


        // Initial setup
        resetGame(); // Start the first game
    });
</script>

<style>
    /* Styles specific to the explanation section */
    .explanation-panel {
        margin-top: 20px;
        padding: 25px;
        background-color: #fff;
        border-radius: 12px;
        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
        border: 1px solid #dee2e6;
        line-height: 1.7;
        color: #343a40;
        font-family: 'Heebo', sans-serif;
    }

    .explanation-panel h2 {
        color: #007bff;
        text-align: center;
        margin-bottom: 25px;
        font-weight: 700;
        display: flex;
        align-items: center;
        justify-content: center;
    }
    .explanation-panel h2 i {
        margin-left: 10px;
        font-size: 1.2em;
    }

    .explanation-panel h3 {
        color: #495057;
        margin-top: 20px;
        margin-bottom: 10px;
        font-weight: 700;
        border-bottom: 1px dashed #ced4da;
        padding-bottom: 5px;
        display: flex;
        align-items: center;
    }
     .explanation-panel h3 i {
         margin-left: 8px;
         color: #007bff;
     }


    .explanation-panel p {
        margin-bottom: 15px;
    }

    .toggle-button {
        display: block;
        width: fit-content;
        margin: 20px auto;
        padding: 10px 20px;
        background-color: #007bff;
        color: white;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-size: 1em;
        transition: background-color 0.3s ease, transform 0.1s ease;
        display: flex;
        align-items: center;
    }
     .toggle-button i {
         margin-left: 8px;
     }
    .toggle-button:hover {
        background-color: #0056b3;
        transform: translateY(-2px);
    }
    .toggle-button.active {
         background-color: #28a745; /* Green when active/showing */
    }
    .toggle-button.active:hover {
        background-color: #218838;
    }

</style>
```