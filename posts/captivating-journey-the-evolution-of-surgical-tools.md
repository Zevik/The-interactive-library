---
title: "住注 : 爪 专转拽转 砖  转"
english_slug: captivating-journey-the-evolution-of-surgical-tools
category: "专驻"
tags:
  - 住专
  - 专驻
  - 转
  -  专驻转
  - 专专
  - 住爪
---
<h1>住注 : 爪 专转拽转 砖  转</h1>
<p>爪专驻  住注 专转拽  注专 专驻!  转 驻注 注   转 专驻 驻 转  驻 砖 砖 住 爪 ? 爪 驻爪  驻  爪转  拽?  转 爪  转 转驻转 驻爪 驻专  驻  砖 , 爪 转驻转转  砖转 转 转 专驻 驻砖专转.</p>

<div class="simulation-container">
    <h2>转住转: 住专转 转 </h2>
    <p class="sim-intro">专 转拽驻 住专转, 转住 砖砖  驻  住 转拽 转 注专.  转爪 转专 注 转专 砖爪  转拽驻?</p>

    <div class="era-selector">
        <label for="era-select">专 转拽驻转  住注:</label>
        <select id="era-select">
            <option value="ancient">注转 注转拽 ( /专)</option>
            <option value="medieval">  (专 住)</option>
            <option value="early-modern">转转 注转 砖 (驻 驻砖)</option>
            <option value="19th-century"> -19 (注 住专爪)</option>
            <option value="20th-century"> -20 (专住 转转)</option>
            <option value="modern"> ( 注转)</option>
        </select>
    </div>

    <div class="simulation-area">
        <div class="patient-area" id="patient-area">
            <div class="wound">
                 <div class="cut-edge left-edge"></div>
                 <div class="cut-edge right-edge"></div>
            </div>
             <div class="wound-overlay" id="wound-overlay">
                  <!-- Damage/Suture markers go here -->
             </div>
        </div>
        <div class="tools-area" id="tools-area">
            <!-- Tools will be loaded here by JS -->
        </div>
    </div>

    <div class="simulation-feedback" id="simulation-feedback">
        <!-- Feedback will be displayed here -->
    </div>
     <div class="simulation-stats">
         <span id="suture-count">转驻专: 0 / --</span>
         <span id="damage-count">拽 爪专: 0</span>
     </div>
    <button id="reset-sim">转 砖 砖 住爪</button>
</div>

<button id="toggle-explanation">爪/住转专 转 住驻专  专 </button>

<div id="explanation" style="display: none;">
    <h3>住专 砖  转 - 住驻专 </h3>
    <p> 转  专 砖拽 住专 砖 专驻. 转驻转转  专拽 住驻专 ,  砖拽祝 专转拽 砖 驻  砖转  转 祝, 转 注 转 驻爪注转, 驻 转 转 驻砖专.</p>

    <h4>注转 注转拽:  注 转转 注 砖专转</h4>
    <p>转拽驻转 拽转 转专, 专专 转 专 驻专爪专 砖 专, 转 驻 驻爪注转 转  砖专 转 (砖 注转 转 专驻爪 - 拽转 专 转)  拽注转 驻 注拽转 专.   驻砖: , 住 住专 注砖  转 (爪专, 住)  转转 驻专转  专.    住, 拽砖 拽, 专 拽 专 专拽转 住转 转 专 驻. 注专  砖 注 注 拽  住专爪 驻  驻转转 注专 驻注 注转 住 专  拽. 拽 专 砖, 砖砖 注拽专 砖驻转 驻爪 专  砖专 注爪转 驻爪注.</p>

    <h4>  转转 注转 砖:   转</h4>
    <p>转拽驻转   专转 砖驻专 专转 转 转转 (专, 驻 驻砖),   转专  注爪 住住 注转拽. 转拽驻 , 转 住址驻旨指旨专-转   注拽专 砖注住拽 驻专爪专转 爪转  拽转 , 拽注转, 驻 驻爪注. 注   拽, 砖 住专爪 注   拽.   拽 专  专  砖 驻爪注转 拽专 转 专转. 转拽驻  转驻 砖注专 转转  专 专 转, 砖 专 爪 专 砖.</p>

    <h4> -19: 驻 转注砖转转 驻转 住专爪</h4>
    <p> -19  转拽驻转 驻 专. 砖  注 砖 转 驻 专专 爪: 驻转 专 专 注 (转专, 专驻专), 砖驻砖专 转 注  拽 转专 注  砖拽  ,  注拽专转 住驻拽 住专爪 注  '祝 住专  驻住专. 驻转注, 转  驻转 专转 转 住 . 拽, 驻 转注砖转转 驻砖专 爪专  砖  驻 转 转专,  转专, 注 转专.  注爪 砖  砖 拽 转专 拽 注拽专. 砖 砖 专, 住专爪  砖驻专 驻转 转 转 驻专爪专转 专专转 专转 专 转专, 转  祝 驻.</p>

    <h4> -20: 转转, 专住 驻转 </h4>
    <p>注 转拽转 注 专驻, 专专 驻 转 转专 转专 (专专转 -, 专专专, 专转驻 ').  注 专 驻转  注转 注 爪专 转转 砖转. 注专 驻 专住 (驻转 -) 驻砖专  转 注 转专 驻 拽专 拽 转专 拽 注拽专 专. 转驻转转 拽转   爪 专 砖 CT -MRI, 砖驻注   注 爪专  砖 驻注 转 . 驻转 住拽驻 专砖转 ( 驻砖专 爪爪  祝 驻)  爪注 专砖 拽专转 专专 驻砖转 转.</p>

    <h4>住祝  -20 注 : 驻 注专-驻砖转 注 </h4>
    <p>注砖专 专 注 住 驻 砖 砖: 专专 驻砖转 转 (Minimal Invasive Surgery - MIS), 注拽专 驻专住拽驻 住拽驻. 拽 驻转转 转 , 转 专 爪注  专 转 拽 转专 爪注转  专 拽 专 爪. 专 专砖 住 砖  砖 . 住祝, 转 注转 住 专 转: 专专 专转 ( 注专转  爪') 驻砖专转 转 砖  拽 转专 爪注转 拽住, 注转 祝 专拽; 砖砖 专 转 爪专 拽; 注专转  转-转转 转 ; 砖砖 专 拽转  转拽转 转  转.</p>

    <h4> 注转: , 专 转 砖转</h4>
    <p>注转  砖 转 拽爪 砖转 住专专.  爪驻 专转  "" 注 砖  住驻拽 注 转  转, 砖 爪转 专 (AR) 拽专转 注 注 砖 转, 砖砖 驻住转 转转- 爪专转  转  砖转 转 砖转 , 砖 注拽 转专 砖  转转 转 转 转 专.  转 专 驻 转  转专, 拽 转专, 驻转 转   砖 驻.</p>
</div>

<style>
    body {
        font-family: 'Arial', sans-serif;
        line-height: 1.7;
        direction: rtl;
        text-align: right;
        margin: 0;
        padding: 20px;
        background-color: #f4f7f6; /* Soft background */
        color: #333;
    }

    h1, h2, h3, h4 {
        color: #004085; /* Deep blue */
        margin-bottom: 10px;
    }

    p {
        margin-bottom: 15px;
    }

    .simulation-container {
        border: 1px solid #b8daff; /* Light blue border */
        padding: 25px;
        margin: 25px 0;
        background-color: #e9f5ff; /* Very light blue */
        border-radius: 10px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }

    .sim-intro {
        font-style: italic;
        color: #5a6268; /* Greyish */
        margin-top: -10px;
        margin-bottom: 20px;
    }

    .era-selector {
        margin-bottom: 25px;
        text-align: center;
        display: flex;
        flex-direction: column;
        align-items: center;
    }

    .era-selector label {
         font-weight: bold;
         margin-bottom: 8px;
         color: #004085;
    }

    .era-selector select {
        padding: 10px 15px;
        font-size: 1em;
        border: 1px solid #007bff;
        border-radius: 5px;
        background-color: #fff;
        cursor: pointer;
        outline: none;
        transition: border-color 0.3s ease;
        min-width: 200px; /* Ensure dropdown is wide enough */
    }

     .era-selector select:focus {
         border-color: #0056b3;
         box-shadow: 0 0 5px rgba(0, 123, 255, 0.5);
     }


    .simulation-area {
        display: flex;
        flex-direction: column; /* Stack on small screens */
        gap: 20px;
        justify-content: center;
        align-items: center; /* Center vertically */
    }

     @media (min-width: 768px) { /* Switch to side-by-side on larger screens */
        .simulation-area {
            flex-direction: row-reverse; /* Tools on left, patient on right */
            align-items: flex-start; /* Align items to the top */
        }
         .tools-area {
             min-width: 180px; /* More space for tools */
             max-width: 250px;
         }
     }


    .patient-area {
        position: relative;
        width: 100%; /* Flexible width */
        max-width: 400px; /* Max width for larger screens */
        height: 200px; /* Fixed height */
        border: 2px solid #8d6e63; /* Skin tone border */
        background-color: #ffe0b2; /* Skin tone color */
        overflow: hidden;
        border-radius: 10px;
        flex-shrink: 0;
        margin-bottom: 20px; /* Space below patient area on small screens */
         cursor: crosshair; /* Indicate clickability */
         box-shadow: inset 0 0 15px rgba(141, 110, 99, 0.3); /* Inner shadow for depth */
    }
     @media (min-width: 768px) {
          .patient-area {
               margin-bottom: 0; /* Remove bottom margin when side-by-side */
          }
     }


    .wound {
         position: absolute;
         top: 50%;
         left: 10%;
         width: 80%;
         height: 10px; /* Height representing the open cut */
         transform: translateY(-50%);
         display: flex;
         justify-content: center;
         align-items: center;
         pointer-events: none; /* Wound itself isn't interactive */
         z-index: 1;
    }

    .cut-edge {
        width: 50%;
        height: 100%;
        background-color: #c62828; /* Dark red representing muscle/blood */
        transition: margin 0.5s ease-out; /* Animation for closing */
    }

    .left-edge {
        margin-right: 5px; /* Initial gap */
        border-top-left-radius: 5px;
        border-bottom-left-radius: 5px;
    }

     .right-edge {
        margin-left: 5px; /* Initial gap */
         border-top-right-radius: 5px;
        border-bottom-right-radius: 5px;
    }

    .wound-overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 2; /* Overlay for interaction points */
    }


    .tools-area {
        width: 100%; /* Full width on small screens */
        border-top: 1px solid #eee; /* Separator on small screens */
        padding-top: 10px;
        display: flex;
        flex-direction: column;
        gap: 8px; /* Reduced gap */
        align-items: stretch; /* Stretch items */
    }
     @media (min-width: 768px) {
        .tools-area {
             border-top: none;
             border-right: 1px solid #eee; /* Separator on larger screens */
             padding-top: 0;
             padding-right: 10px;
        }
     }


    .tool {
        padding: 12px 15px; /* More padding */
        border: 1px solid #cce5ff; /* Light blue border */
        background-color: #ffffff; /* White background */
        cursor: pointer;
        border-radius: 6px; /* Slightly more rounded */
        width: 100%; /* Full width */
        text-align: center;
        user-select: none;
        transition: transform 0.1s ease-in-out, background-color 0.2s ease, border-color 0.2s ease;
        font-size: 0.95em;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
    }

    .tool:hover {
        background-color: #e9f5ff; /* Lighter blue on hover */
        border-color: #a6d1f5;
    }

    .tool.selected {
        border-color: #007bff; /* Primary blue */
        background-color: #cce5ff; /* Lightest blue for selected */
        box-shadow: 0 3px 6px rgba(0, 123, 255, 0.2);
        transform: translateY(-2px); /* Slight lift */
    }

     /* Styles for simulation elements (e.g., sutures, damage) */
     .marker {
         position: absolute;
         transform: translate(-50%, -50%); /* Center point at location */
         z-index: 3;
         pointer-events: none; /* Markers are not interactive */
         opacity: 0; /* Start hidden for animation */
         animation: fade-in 0.5s forwards;
     }

     @keyframes fade-in {
         to { opacity: 1; }
     }


    .suture {
        width: 12px; /* Size of a suture point */
        height: 12px;
        background-color: #007bff; /* Blue */
        border-radius: 50%;
        border: 2px solid #0056b3;
        box-shadow: 0 0 5px rgba(0, 123, 255, 0.5);
        animation: pop-in 0.3s ease-out forwards;
     }

      @keyframes pop-in {
          0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0.5; }
          80% { transform: translate(-50%, -50%) scale(1.1); opacity: 1; }
          100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
      }

     .suture-line { /* Visual line connecting suture points if needed (more complex JS) */
         /* Not implementing line connecting for simplicity now, just points */
     }


    .damage {
        width: 25px; /* Size of a damage point */
        height: 25px;
        background-color: rgba(220, 53, 69, 0.6); /* Semi-transparent red */
        border-radius: 50%;
        border: 2px solid #a71d2a;
        box-shadow: 0 0 8px rgba(220, 53, 69, 0.8);
         animation: pulse 1s infinite alternate, fade-in 0.5s forwards; /* Add pulse effect */
     }

     @keyframes pulse {
         from { transform: translate(-50%, -50%) scale(1); opacity: 0.8; }
         to { transform: translate(-50%, -50%) scale(1.1); opacity: 1; }
     }


    .simulation-feedback {
        margin-top: 20px;
        padding: 15px;
        text-align: center;
        font-weight: bold;
        min-height: 1.5em; /* Reserve space */
        border-radius: 6px;
        background-color: #fff3cd; /* Warning yellow background */
        color: #856404; /* Warning yellow text */
        border: 1px solid #ffeeba;
        transition: all 0.5s ease;
    }

     .simulation-feedback.success {
         background-color: #d4edda; /* Success green */
         color: #155724;
         border-color: #c3e6cb;
     }

      .simulation-feedback.failure {
         background-color: #f8d7da; /* Danger red */
         color: #721c24;
         border-color: #f5c6cb;
     }


     .simulation-stats {
         margin-top: 15px;
         text-align: center;
         font-size: 1em;
         color: #555;
     }

     .simulation-stats span {
         margin: 0 15px;
         font-weight: bold;
     }


    #reset-sim {
        display: block;
        margin: 20px auto 0;
        padding: 12px 25px;
        font-size: 1em;
        cursor: pointer;
        background-color: #ffc107; /* Warning button */
        color: #212529;
        border: none;
        border-radius: 5px;
        transition: background-color 0.3s ease, transform 0.1s ease;
    }
    #reset-sim:hover {
         background-color: #e0a800;
         transform: translateY(-1px);
    }
     #reset-sim:active {
          transform: translateY(0);
     }


    #toggle-explanation {
        display: block;
        margin: 30px auto;
        padding: 12px 25px;
        font-size: 1em;
        cursor: pointer;
        background-color: #007bff; /* Primary button */
        color: white;
        border: none;
        border-radius: 5px;
         transition: background-color 0.3s ease, transform 0.1s ease;
    }
     #toggle-explanation:hover {
         background-color: #0056b3;
         transform: translateY(-1px);
     }
      #toggle-explanation:active {
           transform: translateY(0);
      }


    #explanation {
        margin-top: 20px;
        padding: 20px;
        border: 1px solid #b8daff;
        background-color: #e9f5ff; /* Same as sim container */
        border-radius: 10px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
         transition: all 0.5s ease; /* Smooth toggle */
    }

    #explanation h3 {
        margin-top: 0;
        border-bottom: 2px solid #007bff; /* Separator */
        padding-bottom: 5px;
        margin-bottom: 15px;
    }

    #explanation h4 {
        margin-bottom: 8px;
        color: #0056b3; /* Slightly darker blue */
        font-weight: bold;
    }
</style>

<script>
    const eras = {
        ancient: {
            name: "注转 注转拽",
            tools: [
                { name: "住  住", type: "damage", precision: 0.1, baseEffect: 30, description: " 转, 专转 拽 专  拽." },
                { name: " 注爪", type: "suture", precision: 0.15, baseEffect: 40, description: "驻专转 砖专, 拽砖 转驻专 注转." }
            ],
            description: " 住, 拽 , 住 专  拽 专拽.",
            suturePointsNeeded: 5, // Fewer points needed, representing crude closure
            damageTolerance: 80 // Low tolerance before failure
        },
        medieval: {
            name: " ",
            tools: [
                 { name: " 专", type: "damage", precision: 0.2, baseEffect: 25, description: " 转专 , 注  拽砖 砖." },
                { name: " 专 住", type: "suture", precision: 0.3, baseEffect: 35, description: "注 转专 注爪, 注 住 拽砖 注 注." }
            ],
            description: "专  转专,  拽  注 专拽 拽.",
            suturePointsNeeded: 7,
            damageTolerance: 120
        },
        'early-modern': {
            name: "转转 注转 砖",
            tools: [
                 { name: " 驻 驻砖", type: "damage", precision: 0.3, baseEffect: 20, description: "驻 砖驻专转 转 转,  注 住专 拽 转." },
                { name: " 驻", type: "suture", precision: 0.4, baseEffect: 30, description: " 拽 转专, 驻砖专转 拽爪转 转专 砖." }
            ],
            description: "驻 住转 砖砖,  注 转专,  住专爪 注 住专.",
             suturePointsNeeded: 9,
            damageTolerance: 150
        },
        '19th-century': {
            name: " -19 (注 住专爪)",
            tools: [
                 { name: " 驻 注", type: "damage", precision: 0.6, baseEffect: 15, description: "驻 转转 驻砖专转 转 拽 转专,  砖砖 专专  砖 转拽." },
                { name: " 驻 拽 (注拽专)", type: "suture", precision: 0.7, baseEffect: 20, description: "住专爪 拽 砖驻专 专转 转 住 转驻专 爪." }
            ],
            description: "驻转 住专爪 专 爪 驻 转转 - 拽驻爪转 专 专.",
            suturePointsNeeded: 12,
            damageTolerance: 250 // Higher tolerance due to sterility reducing infection damage
        },
        '20th-century': {
            name: " -20",
             tools: [
                 { name: " 专住", type: "damage", precision: 0.8, baseEffect: 10, description: "专住 注 驻  拽 注拽专, 拽转 ." },
                { name: " 专住 注", type: "suture", precision: 0.85, baseEffect: 15, description: " 专住 驻砖专 注 注 拽转 转专." }
            ],
            description: "专住 驻转 住专, 转转 专转,  注 专.",
            suturePointsNeeded: 15,
            damageTolerance: 350
        },
        modern: {
            name: "",
             tools: [
                 { name: " 拽专-专专 (爪)", type: "damage", precision: 0.95, baseEffect: 5, description: "拽 专, 拽 ,    住专." },
                { name: " 住专 拽", type: "suture", precision: 0.98, baseEffect: 10, description: "专拽, 专,   - 拽 注 砖." }
            ],
            description: "专专 注专-驻砖转, 专拽, 拽 注-砖, 拽 注专 转爪转 转.",
            suturePointsNeeded: 20, // More points for fine closure
            damageTolerance: 500 // Very high tolerance due to precision and minimal invasiveness
        }
    };

    let selectedTool = null;
    let currentEra = 'ancient';
    let suturesPlaced = 0;
    let totalDamage = 0;
    let simActive = true;

    const eraSelect = document.getElementById('era-select');
    const toolsArea = document.getElementById('tools-area');
    const woundOverlay = document.getElementById('wound-overlay');
    const patientArea = document.getElementById('patient-area');
    const feedbackArea = document.getElementById('simulation-feedback');
    const resetButton = document.getElementById('reset-sim');
    const explanationDiv = document.getElementById('explanation');
    const toggleExplanationButton = document.getElementById('toggle-explanation');
    const sutureCountSpan = document.getElementById('suture-count');
    const damageCountSpan = document.getElementById('damage-count');
    const leftCutEdge = document.querySelector('.left-edge');
    const rightCutEdge = document.querySelector('.right-edge');


    // Event Listeners
    eraSelect.addEventListener('change', changeEra);
    woundOverlay.addEventListener('click', handleSimulationClick);
    resetButton.addEventListener('click', resetSimulation);
    toggleExplanationButton.addEventListener('click', () => {
        const isHidden = explanationDiv.style.display === 'none';
        explanationDiv.style.display = isHidden ? 'block' : 'none';
        toggleExplanationButton.textContent = isHidden ? '住转专 转 住驻专 ' : '爪/住转专 转 住驻专  专 ';
    });

    // Initialize simulation
    loadTools(currentEra);
    updateStatsDisplay();
    updateFeedback(`专  住注 ! 专 转拽驻  转 转拽 转.`);
    setWoundAppearance(eras[currentEra]);


    function loadTools(eraKey) {
        toolsArea.innerHTML = '';
        selectedTool = null; // Deselect tool on era change
        eras[eraKey].tools.forEach(tool => {
            const toolDiv = document.createElement('div');
            toolDiv.classList.add('tool');
            toolDiv.textContent = tool.name;
            toolDiv.title = tool.description; // Add tooltip for description
            toolDiv.dataset.type = tool.type;
            toolDiv.dataset.precision = tool.precision;
            toolDiv.dataset.baseEffect = tool.baseEffect;
            toolDiv.addEventListener('click', selectTool);
            toolsArea.appendChild(toolDiv);
        });
    }

    function selectTool(event) {
        if (!simActive) return;
        // Remove 'selected' class from all tools
        toolsArea.querySelectorAll('.tool').forEach(tool => tool.classList.remove('selected'));

        // Select the clicked tool
        event.target.classList.add('selected');
        selectedTool = {
            name: event.target.textContent,
            type: event.target.dataset.type,
            precision: parseFloat(event.target.dataset.precision),
            baseEffect: parseFloat(event.target.dataset.baseEffect)
        };
         updateFeedback(` 专: ${selectedTool.name}. ${selectedTool.description}`);
    }

    function handleSimulationClick(event) {
        if (!simActive) return;
        if (!selectedTool) {
            updateFeedback(" 专  转 转  爪注 驻注.");
            return;
        }

        // Get click position relative to the patient area
        const rect = patientArea.getBoundingClientRect();
        const x = event.clientX - rect.left;
        const y = event.clientY - rect.top;

        // Check if click is near the cut line (simplified check)
        // Assuming the cut line is roughly in the middle vertically and spans 80% horizontally
        const cutLineY = patientArea.offsetHeight / 2;
        const cutLineStartX = patientArea.offsetWidth * 0.1;
        const cutLineEndX = patientArea.offsetWidth * 0.9;
        const distanceToCutCenterY = Math.abs(y - cutLineY);
        const clickIsNearCutY = distanceToCutCenterY < 20; // Vertical tolerance
        const clickIsWithinCutX = x >= cutLineStartX && x <= cutLineEndX; // Horizontal range

        const clickIsNearCut = clickIsNearCutY && clickIsWithinCutX;


        let outcomeMessage = "";

        if (selectedTool.type === 'suture') {
            if (clickIsNearCut) {
                 const successProb = selectedTool.precision; // Probability of successful suture placement
                 const potentialDamage = selectedTool.baseEffect * (1 - selectedTool.precision); // Damage related to imprecision

                 if (Math.random() < successProb) {
                     // Successful suture placement
                     addMarker(x, y, 'suture');
                     suturesPlaced++;
                      totalDamage += potentialDamage * 0.5; // Minimal damage even on success
                     outcomeMessage = `转驻专  爪! (${(successProb*100).toFixed(0)}% 住 注  ).`;
                 } else {
                     // Failed suture placement (e.g., slipped, broke)
                     totalDamage += selectedTool.baseEffect * (1 + (1-selectedTool.precision)); // More damage on failure
                     addMarker(x, y, 'damage', totalDamage); // Add visual damage marker
                     outcomeMessage = `住 转驻专 砖! (${((1-successProb)*100).toFixed(0)}% 住 砖). 专 拽 住祝.`;
                 }
            } else {
                // Clicking with suture tool away from the cut
                 totalDamage += selectedTool.baseEffect * 0.8; // Damage for misapplication
                 addMarker(x, y, 'damage', totalDamage); // Add visual damage marker
                 outcomeMessage = `住转 转驻专 抓 转! 专 拽 专拽.`;
            }
        } else if (selectedTool.type === 'damage') { // This tool type is for things that *should* cause damage if misused for repair
             const damageAmount = selectedTool.baseEffect * (1 + (1-selectedTool.precision)); // Damage related to tool nature and imprecision
             totalDamage += damageAmount;
             addMarker(x, y, 'damage', totalDamage); // Add visual damage marker
             outcomeMessage = `  转/专,  转拽! 专 拽 砖注转 专拽.`;
        }

        updateStatsDisplay();
        checkSimulationStatus(outcomeMessage);
    }

    function addMarker(x, y, type, damageValue = 0) {
        const marker = document.createElement('div');
        marker.classList.add('marker', type);
        marker.style.left = `${x}px`;
        marker.style.top = `${y}px`;

        if (type === 'damage') {
             // Optional: Scale damage marker size based on the individual damage caused, not totalDamage
            const size = Math.max(15, Math.min(40, damageValue / 15)); // Scale based on impact
             marker.style.width = `${size}px`;
             marker.style.height = `${size}px`;
        }

        woundOverlay.appendChild(marker);

         // Optional: Remove old markers after a while to avoid clutter
         if (type === 'damage') {
             setTimeout(() => {
                 marker.remove();
             }, 3000); // Remove damage markers after 3 seconds
         }
    }

    function updateStatsDisplay() {
         const currentEraData = eras[currentEra];
        sutureCountSpan.textContent = `转驻专: ${suturesPlaced} / ${currentEraData.suturePointsNeeded}`;
        damageCountSpan.textContent = `拽 爪专: ${totalDamage.toFixed(0)} / ${currentEraData.damageTolerance}`;
    }

    function checkSimulationStatus(latestOutcomeMessage) {
        const currentEraData = eras[currentEra];

         // Update wound visual based on sutures placed
         const sutureProgress = suturesPlaced / currentEraData.suturePointsNeeded;
         const gap = Math.max(0, 5 - (sutureProgress * 5)); // Reduce gap from 5px to 0
         leftCutEdge.style.marginRight = `${gap}px`;
         rightCutEdge.style.marginLeft = `${gap}px`;


        if (totalDamage >= currentEraData.damageTolerance) {
            updateFeedback(`转 砖!  专 拽 专  专拽 转 转拽驻转 ${currentEraData.name} (${totalDamage.toFixed(0)}/${currentEraData.damageTolerance}). 拽砖 爪 注  驻专/ 住专爪!`, 'failure');
            simActive = false;
            // Prevent further interaction
            woundOverlay.style.pointerEvents = 'none';
             toolsArea.style.pointerEvents = 'none';
             toolsArea.querySelectorAll('.tool').forEach(tool => tool.classList.remove('selected')); // Deselect
             selectedTool = null;

        } else if (suturesPlaced >= currentEraData.suturePointsNeeded) {
            updateFeedback(`转 爪!  转 住专 爪 转 转拽驻转 ${currentEraData.name}. 拽  专 (${totalDamage.toFixed(0)}/${currentEraData.damageTolerance}). 转 砖 拽 转  !`, 'success');
            simActive = false;
             // Prevent further interaction
            woundOverlay.style.pointerEvents = 'none';
             toolsArea.style.pointerEvents = 'none';
             toolsArea.querySelectorAll('.tool').forEach(tool => tool.classList.remove('selected')); // Deselect
             selectedTool = null;
        } else {
             // Simulation is still active, display the latest outcome message
             updateFeedback(latestOutcomeMessage + ` 转专 转拽: ${currentEraData.suturePointsNeeded - suturesPlaced}.`);
        }
    }

     function updateFeedback(message, type = 'info') {
        feedbackArea.textContent = message;
        feedbackArea.className = 'simulation-feedback'; // Reset classes
         if (type === 'success') {
             feedbackArea.classList.add('success');
         } else if (type === 'failure') {
             feedbackArea.classList.add('failure');
         } else {
              feedbackArea.classList.add('info'); // Default class
         }
    }

    function changeEra() {
        currentEra = eraSelect.value;
        resetSimulation(); // Reset simulation state for the new era
        loadTools(currentEra);
        setWoundAppearance(eras[currentEra]);
        updateStatsDisplay();
        updateFeedback(`转拽驻 专: ${eras[currentEra].name}. ${eras[currentEra].description} 住 住专 转 转 爪注转  . 转专 转拽: ${eras[currentEra].suturePointsNeeded}`);
    }

    function resetSimulation() {
        suturesPlaced = 0;
        totalDamage = 0;
        simActive = true;
        // Clear all markers
        woundOverlay.innerHTML = '';
        selectedTool = null;
         // Deselect all tools
        toolsArea.querySelectorAll('.tool').forEach(tool => tool.classList.remove('selected'));
        updateStatsDisplay();
         updateFeedback(`住爪 驻住 转拽驻转 ${eras[currentEra].name}. 专  转  转.`);
         // Re-enable interaction
         woundOverlay.style.pointerEvents = 'auto';
         toolsArea.style.pointerEvents = 'auto';
         setWoundAppearance(eras[currentEra]); // Reset wound visual
    }

     function setWoundAppearance(eraData) {
          // For now, this just resets the gap. Could potentially add visual changes
          // like more redness/swelling for older eras.
         leftCutEdge.style.marginRight = '5px';
         rightCutEdge.style.marginLeft = '5px';
     }


</script>